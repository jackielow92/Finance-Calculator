<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Calculators: By Jackie Low</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #e0e5ec;
            --text-main: #4d5b7c;
            --text-sec: #65718a;
            --primary-color: #6d5dfc;
            
            /* Neumorphism Shadows */
            --shadow-light: #ffffff;
            --shadow-dark: #a3b1c6;
            
            /* Box Shadows */
            --neumorph-out: 9px 9px 16px var(--shadow-dark), 
                            -9px -9px 16px var(--shadow-light);
            --neumorph-in: inset 6px 6px 10px var(--shadow-dark), 
                           inset -6px -6px 10px var(--shadow-light);
            --neumorph-flat: 5px 5px 10px var(--shadow-dark), 
                             -5px -5px 10px var(--shadow-light);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        h1 {
            margin-bottom: 30px;
            color: var(--text-main);
            text-align: center;
            font-size: 2.2rem;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        h3 {
            margin-bottom: 20px;
            color: var(--text-main);
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        /* Tab Styles */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: none;
            gap: 20px;
            padding: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            background-color: var(--bg-color);
            border: none;
            border-radius: 30px;
            margin-right: 0;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            color: var(--text-sec);
            font-weight: 700;
            box-shadow: var(--neumorph-out);
            /* Prevent shrinking on mobile */
            flex-shrink: 0;
        }
        
        .tab i {
            margin-right: 10px;
        }
        
        .tab:hover {
            transform: translateY(-2px);
            color: var(--primary-color);
        }
        
        .tab.active {
            background-color: var(--bg-color);
            color: var(--primary-color);
            box-shadow: var(--neumorph-in);
            border-bottom: none;
            margin-bottom: 0;
            font-weight: 800;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
            background-color: var(--bg-color);
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            flex: 1;
            overflow-y: visible;
        }
        
        .tab-content.active {
            display: flex;
            flex-direction: column;
        }
        
        /* Input Section */
        .input-section {
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: var(--neumorph-out);
            border: none;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-sec);
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .input-group label i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .input-group input, .input-group select {
            padding: 12px 15px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-family: inherit;
            background-color: var(--bg-color);
            box-shadow: var(--neumorph-in);
            color: var(--text-main);
            transition: all 0.3s ease;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            box-shadow: var(--neumorph-in), 0 0 5px rgba(109, 93, 252, 0.2);
        }

        .helper-text {
            margin-top: 8px;
            font-size: 12px;
            color: var(--text-sec);
            font-style: italic;
        }

        .info-box {
            padding: 15px;
            border-radius: 12px;
            background-color: var(--bg-color);
            font-size: 0.95rem;
            box-shadow: var(--neumorph-in);
            color: var(--text-sec);
        }

        .col-span-2 {
            grid-column: span 2;
        }

        .mt-4 {
            margin-top: 15px;
        }

        .hidden {
            display: none !important;
        }

        @media (max-width: 768px) {
            .col-span-2 {
                grid-column: span 1;
            }
        }
        
        /* Summary Section */
        .summary-section {
            margin-bottom: 20px;
        }
        
        .summary-card {
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background-color: var(--bg-color);
            border-radius: 15px;
            box-shadow: var(--neumorph-out);
            border-left: 4px solid var(--primary-color);
            align-items: center;
        }
        
        .summary-item span:first-child {
            font-weight: 600;
            color: var(--text-sec);
        }
        
        .summary-value {
            font-weight: 800;
            color: var(--primary-color);
            font-size: 16px;
        }
        
        .summary-value-large {
            font-weight: 800;
            color: #4CAF50;
            font-size: 18px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        /* Chart Section */
        .chart-section {
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            margin-bottom: 20px;
            position: relative;
            height: 350px;
            flex-shrink: 0;
        }
        
        .chart-container {
            position: relative;
            height: 100%;
            width: 100%;
        }
        
        /* Table Section */
        .table-section {
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            flex: 1;
            min-height: 0;
        }
        
        .table-wrapper {
            overflow: auto;
            margin-top: 20px;
            border-radius: 15px;
            height: calc(100% - 60px);
            box-shadow: var(--neumorph-in);
            padding: 10px;
            background-color: var(--bg-color);
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 14px;
        }
        
        table thead {
            background-color: var(--bg-color);
            color: var(--text-main);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        table th {
            padding: 15px;
            text-align: left;
            font-weight: 700;
            border-bottom: 2px solid rgba(0,0,0,0.05);
            color: var(--primary-color);
        }
        
        table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0,0,0,0.03);
            color: var(--text-sec);
        }
        
        table tbody tr:nth-child(even) {
            background-color: rgba(255,255,255,0.3);
        }
        
        table tbody tr:hover {
            background-color: rgba(255,255,255,0.5);
        }
        
        table tbody tr td:last-child {
            font-weight: 700;
            color: #4CAF50;
        }
        
        /* Salary Calculator Specific Styles */
        .salary-statement {
            background-color: var(--bg-color);
            padding: 25px;
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .salary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding-bottom: 15px;
        }
        
        .salary-title {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--text-main);
        }
        
        .salary-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 25px;
            box-shadow: var(--neumorph-in);
            border-radius: 15px;
            padding: 10px;
            background: var(--bg-color);
        }
        
        .salary-table th, .salary-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid rgba(0,0,0,0.03);
        }
        
        .salary-table th:first-child, .salary-table td:first-child {
            text-align: left;
        }
        
        .salary-table th {
            background-color: transparent;
            font-weight: 700;
            color: var(--text-main);
        }
        
        .salary-table .total-row {
            font-weight: 800;
            color: var(--primary-color);
            border-top: 2px solid rgba(0,0,0,0.05);
        }
        
        .salary-table .highlight-row {
            background-color: rgba(76, 175, 80, 0.1);
            border-radius: 10px;
        }
        
        .deduction-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            box-shadow: var(--neumorph-in);
            border-radius: 15px;
            padding: 10px;
            background: var(--bg-color);
        }
        
        .deduction-table th, .deduction-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid rgba(0,0,0,0.03);
        }
        
        .deduction-table th:first-child, .deduction-table td:first-child {
            text-align: left;
        }
        
        .deduction-table th {
            background-color: transparent;
            color: var(--primary-color);
            font-weight: 700;
        }
        
        .deduction-table .total-row {
            font-weight: 800;
            border-top: 2px solid rgba(0,0,0,0.05);
            color: var(--text-main);
        }
        
        /* Tax Explanation Section */
        .tax-explanation {
            background-color: var(--bg-color);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: var(--neumorph-out);
        }
        
        .tax-explanation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .tax-explanation-header h3 {
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0;
            color: var(--primary-color);
        }
        
        .tax-explanation-header i {
            color: var(--primary-color);
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .tax-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .tax-card {
            background-color: var(--bg-color);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--neumorph-out);
            transition: transform 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .tax-card:hover {
            transform: translateY(-5px);
        }
        
        .tax-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            min-height: 70px; /* Align headers */
        }
        
        .tax-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            flex-shrink: 0;
            box-shadow: var(--neumorph-out);
        }
        
        .epf-icon {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .pcb-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .socso-icon {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .eis-icon {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .tax-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-main);
            line-height: 1.3;
        }
        
        .tax-subtitle {
            font-size: 0.9rem;
            color: var(--text-sec);
            margin-top: 4px;
        }
        
        .tax-description {
            color: var(--text-sec);
            line-height: 1.6;
            margin-bottom: 20px;
            /* Ensure descriptions align the start of the formula */
            flex-grow: 0;
            display: flex;
            align-items: flex-start;
        }
        
        /* Collapsible Styles */
        .tax-collapsible {
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: hidden;
            background-color: var(--bg-color);
            box-shadow: var(--neumorph-out);
        }

        .tax-collapsible-header {
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            color: var(--text-main);
            transition: all 0.2s;
        }

        .tax-collapsible-header:hover {
            color: var(--primary-color);
        }

        .tax-collapsible-header i {
            transition: transform 0.3s ease;
            font-size: 12px;
            color: var(--text-sec);
        }

        .tax-collapsible.active .tax-collapsible-header {
            color: var(--primary-color);
        }

        .tax-collapsible.active .tax-collapsible-header i {
            transform: rotate(180deg);
            color: var(--primary-color);
        }

        .tax-collapsible-content {
            display: none;
            padding: 15px;
            border-top: 1px solid rgba(0,0,0,0.05);
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: var(--text-main);
            background-color: var(--bg-color);
            box-shadow: var(--neumorph-in);
        }
        
        /* Specific content styles */
        .tax-collapsible-content strong {
            color: var(--primary-color);
        }

        .tax-note {
            font-size: 0.85rem;
            color: var(--text-sec);
            font-style: italic;
            margin-top: auto; /* Push to bottom */
            padding-top: 15px;
            opacity: 0.8;
            border-top: 1px solid rgba(0,0,0,0.05); 
        }
        
        /* Housing Loan Calculator Specific Styles */
        .loan-calculator-container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .loan-result-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }
        
        .loan-result-card {
            background-color: var(--bg-color);
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            padding: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .loan-result-card h4 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--text-sec);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .loan-result-card h4 i {
            margin-right: 10px;
            color: var(--primary-color);
        }
        
        .loan-result-value {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--text-main);
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }
        
        .loan-result-description {
            font-size: 14px;
            color: var(--text-sec);
        }
        
        .dsr-good {
            color: #4CAF50;
        }
        
        .dsr-moderate {
            color: #FFC107;
        }
        
        .dsr-high {
            color: #FF9800;
        }
        
        .dsr-very-high {
            color: #F44336;
        }
        
        .loan-buttons {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
            justify-content: center;
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--bg-color);
            color: var(--text-main);
            box-shadow: var(--neumorph-out);
        }
        
        .btn:active {
            box-shadow: var(--neumorph-in);
            transform: translateY(2px);
        }
        
        .btn i {
            margin-right: 10px;
        }
        
        .btn-primary {
            color: var(--primary-color);
        }
        
        .btn-primary:hover {
            color: #5b4bc4;
        }
        
        .btn-secondary {
            color: var(--text-sec);
        }
        
        .btn-secondary:hover {
            color: var(--text-main);
        }
        
        /* Modern Upfront Cost Breakdown Styles */
        .upfront-cost-section {
            margin-top: 30px;
        }
        
        .upfront-cost-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .upfront-cost-header h3 {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-main);
        }
        
        .upfront-cost-header svg {
            color: var(--primary-color);
        }
        
        .upfront-cost-tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: none;
            gap: 20px;
        }
        
        .upfront-cost-tab {
            padding: 12px 25px;
            cursor: pointer;
            background-color: var(--bg-color);
            border: none;
            border-radius: 30px;
            margin-right: 0;
            font-weight: 700;
            color: var(--text-sec);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--neumorph-out);
        }
        
        .upfront-cost-tab:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .upfront-cost-tab.active {
            color: var(--primary-color);
            box-shadow: var(--neumorph-in);
        }
        
        .upfront-cost-tab i {
            font-size: 16px;
        }
        
        .upfront-cost-content {
            display: none;
        }
        
        .upfront-cost-content.active {
            display: block;
        }
        
        .upfront-cost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }
        
        .upfront-cost-card {
            background-color: var(--bg-color);
            border-radius: 20px;
            box-shadow: var(--neumorph-out);
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .cost-card-header {
            padding: 20px;
            background-color: var(--bg-color);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .cost-card-title {
            font-weight: 700;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .cost-card-title i {
            color: var(--primary-color);
        }
        
        .cost-percentage {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cost-percentage input {
            width: 60px;
            padding: 5px 8px;
            border: none;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            background-color: var(--bg-color);
            box-shadow: var(--neumorph-in);
            color: var(--text-main);
        }
        
        .cost-card-body {
            padding: 25px;
        }
        
        .cost-amount {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .cost-description {
            font-size: 14px;
            color: var(--text-sec);
            line-height: 1.4;
        }
        
        .total-cost-card {
            background-color: var(--bg-color);
            border: 2px solid var(--primary-color);
        }
        
        .total-cost-card .cost-card-header {
            background-color: var(--bg-color);
        }
        
        .total-cost-card .cost-amount {
            color: var(--primary-color);
            font-size: 28px;
        }
        
        .fee-explanation {
            margin-top: 35px;
            background-color: var(--bg-color);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--neumorph-out);
        }
        
        .fee-explanation-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .fee-explanation-header h4 {
            font-size: 1.3rem;
            font-weight: 700;
            margin: 0;
            color: var(--text-main);
        }
        
        .fee-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .fee-card {
            background-color: var(--bg-color);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--neumorph-out);
            display: flex;
            align-items: flex-start;
            transition: transform 0.3s ease;
        }
        
        .fee-card:hover {
            transform: translateY(-3px);
        }
        
        .fee-icon {
            background-color: var(--bg-color);
            color: var(--primary-color);
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            box-shadow: var(--neumorph-out);
        }
        
        .fee-details {
            flex: 1;
        }
        
        .fee-name {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-main);
        }
        
        .fee-description {
            font-size: 14px;
            color: var(--text-sec);
            line-height: 1.5;
        }
        
        .fee-note {
            margin-top: 25px;
            padding: 20px;
            background-color: var(--bg-color);
            border-radius: 15px;
            display: flex;
            align-items: flex-start;
            box-shadow: var(--neumorph-in);
        }
        
        .fee-note i {
            margin-right: 15px;
            color: var(--primary-color);
            font-size: 22px;
            margin-top: 2px;
        }
        
        .fee-note-content {
            flex: 1;
        }
        
        .fee-note-title {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
        
        .fee-note-text {
            font-size: 14px;
            color: var(--text-sec);
            line-height: 1.5;
        }
        
        .commitment-breakdown {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed rgba(0,0,0,0.1);
            display: none;
            font-size: 13px;
            color: var(--text-sec);
            width: 100%;
        }
        
        .commitment-breakdown.active {
            display: block;
        }

        .commitment-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .summary-item.column {
            flex-direction: column;
            align-items: stretch;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            align-items: center;
        }

        /* Footer styles */
        footer {
            background-color: #333;
            color: #fff;
            padding: 15px;
            text-align: center;
            margin-top: 20px;
            flex-shrink: 0;
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .footer-links {
            margin-top: 10px;
        }
        
        .footer-links a {
            color: #2196F3;
            text-decoration: none;
            margin: 0 10px;
        }
        
        .footer-links a:hover {
            text-decoration: underline;
        }
        
        /* Responsive styles */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .tabs {
                flex-wrap: nowrap;
                overflow-x: auto;
                justify-content: flex-start;
                padding-bottom: 15px;
                -webkit-overflow-scrolling: touch;
            }
            
            h1 {
                font-size: 1.5rem;
                margin-bottom: 15px;
            }
            
            h3 {
                font-size: 1.1rem;
            }
            
            .input-section, .summary-card, .chart-section, .table-section, .salary-statement {
                padding: 15px;
            }
            
            .input-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-section {
                height: 300px;
            }
            
            table {
                font-size: 12px;
            }
            
            table th, table td {
                padding: 8px;
            }
            
            .salary-table th, .salary-table td, .deduction-table th, .deduction-table td {
                padding: 8px;
            }
            
            .summary-value {
                font-size: 14px;
            }
            
            .summary-value-large {
                font-size: 16px;
            }
            
            .tab {
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .loan-result-cards {
                grid-template-columns: 1fr;
            }
            
            .upfront-cost-grid {
                grid-template-columns: 1fr;
            }
            
            .fee-cards {
                grid-template-columns: 1fr;
            }
            
            .tax-cards {
                grid-template-columns: 1fr;
            }
            
            /* Reset min-heights on mobile for compact view */
            .tax-card-header, .tax-description, .tax-formula {
                min-height: auto;
            }
            
            .tax-card {
                height: auto;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.3rem;
            }
            
            .chart-section {
                height: 250px;
            }
            
            table {
                font-size: 11px;
            }
            
            table th, table td {
                padding: 6px;
            }
            
            .salary-table th, .salary-table td, .deduction-table th, .deduction-table td {
                padding: 6px;
            }
            
            .loan-buttons {
                flex-direction: column;
            }
            
            .upfront-cost-header h3 {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Financial Calculators: By Jackie Low</h1>
        
        <!-- Tab Navigation -->
        <div class="tabs">
            <div class="tab active" onclick="openTab(event, 'compound-interest-tab')">
                <i class="fas fa-chart-line"></i>Compound Interest Calculator
            </div>
            <div class="tab" onclick="openTab(event, 'salary-calculator-tab')">
                <i class="fas fa-money-bill-wave"></i>Salary Calculator
            </div>
            <div class="tab" onclick="openTab(event, 'housing-loan-tab')">
                <i class="fas fa-home"></i>Housing Loan Calculator
            </div>
        </div>
        
        <!-- Compound Interest Tab -->
        <div id="compound-interest-tab" class="tab-content active">
            <!-- Input Section -->
            <div class="input-section">
                <div class="input-grid">
                    <div class="input-group">
                        <label><i class="fas fa-coins"></i>Initial Amount (RM)</label>
                        <input type="number" id="initialAmount" value="10000" />
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-hand-holding-usd"></i>Monthly Contribution (RM)</label>
                        <input type="number" id="monthlyContribution" value="500" />
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-plus-circle"></i>Annual Topup (RM)</label>
                        <input type="number" id="annualTopup" value="0" />
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-percentage"></i>Annual Interest Rate (%)</label>
                        <input type="number" id="annualInterestRate" value="7" step="0.1" />
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-calendar-alt"></i>Length of Time (Years)</label>
                        <input type="number" id="yearsLength" value="30" />
                    </div>
                </div>
            </div>

            <!-- Summary Section -->
            <div class="summary-section">
                <div class="summary-card">
                    <h3>Final Summary</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <span>Total Invested:</span>
                            <span class="summary-value" id="totalInvestedSummary">RM 0.00</span>
                        </div>
                        <div class="summary-item">
                            <span>Interest Earned:</span>
                            <span class="summary-value" id="interestEarnedSummary">RM 0.00</span>
                        </div>
                        <div class="summary-item">
                            <span>Total Amount:</span>
                            <span class="summary-value-large" id="totalAmountSummary">RM 0.00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chart Section -->
            <div class="chart-section">
                <h3>Total Invested vs Total Amount Over Time</h3>
                <div class="chart-container">
                    <canvas id="myChart"></canvas>
                </div>
            </div>

            <!-- Table Section -->
            <div class="table-section">
                <h3>Year-by-Year Breakdown</h3>
                <div class="table-wrapper" id="tableWrapper">
                    <table id="resultsTable">
                        <thead>
                            <tr>
                                <th>Year</th>
                                <th>Monthly Contribution</th>
                                <th>Total Contribution (Annual)</th>
                                <th>Interest Earned</th>
                                <th>Total Invested</th>
                                <th>Total Amount</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Salary Calculator Tab -->
        <div id="salary-calculator-tab" class="tab-content">
            <!-- Input Section -->
            <div class="input-section">
                <div class="input-grid">
                    <div class="input-group">
                        <label><i class="fas fa-money-check"></i>Basic Salary (RM)</label>
                        <input type="number" id="basicSalary" value="10000" />
                    </div>

                    <div class="input-group">
                        <label><i class="fas fa-gift"></i>Bonus (RM)</label>
                        <input type="number" id="bonus" value="0" />
                    </div>

                    
                    <div class="input-group">
                        <label><i class="fas fa-user-tag"></i>PCB Category</label>
                        <select id="pcbCategory">
                            <optgroup label="Single">
                                <option value="B">Single (B)</option>
                            </optgroup>
                            <optgroup label="Married - spouse NOT working (Category 2)">
                                <option value="K2">Married, 0 child (K)</option>
                                <option value="KA1_2">Married, 1 child (KA1)</option>
                                <option value="KA2_2">Married, 2 children (KA2)</option>
                                <option value="KA3_2">Married, 3 children (KA3)</option>
                                <option value="KA4_2">Married, 4 children (KA4)</option>
                                <option value="KA5_2">Married, 5 children (KA5)</option>
                                <option value="KA6_2">Married, 6 children (KA6)</option>
                                <option value="KA7_2">Married, 7 children (KA7)</option>
                                <option value="KA8_2">Married, 8 children (KA8)</option>
                                <option value="KA9_2">Married, 9 children (KA9)</option>
                                <option value="KA10_2">Married, 10 children (KA10)</option>
                            </optgroup>
                            <optgroup label="Married - spouse WORKING (Category 3)">
                                <option value="K3">Married, 0 child (K)</option>
                                <option value="KA1_3">Married, 1 child (KA1)</option>
                                <option value="KA2_3">Married, 2 children (KA2)</option>
                                <option value="KA3_3">Married, 3 children (KA3)</option>
                                <option value="KA4_3">Married, 4 children (KA4)</option>
                                <option value="KA5_3">Married, 5 children (KA5)</option>
                                <option value="KA6_3">Married, 6 children (KA6)</option>
                                <option value="KA7_3">Married, 7 children (KA7)</option>
                                <option value="KA8_3">Married, 8 children (KA8)</option>
                                <option value="KA9_3">Married, 9 children (KA9)</option>
                                <option value="KA10_3">Married, 10 children (KA10)</option>
                            </optgroup>
                        </select>
                    </div>

</div>
            </div>

            <!-- Salary Statement Section -->
            <div class="salary-statement">
                <div class="salary-header">
                    <div class="salary-title">Calculate Monthly PCB, EPF, SOCSO, EIS Deductions</div>
                </div>
                
                <table class="salary-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Amount (RM)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Salary</td>
                            <td id="salaryDisplay">0.00</td>
                        </tr>
                        <tr>
                            <td>Bonus</td>
                            <td id="bonusDisplay">0.00</td>
                        </tr>
                        <tr class="highlight-row">
                            <td>Net Salary</td>
                            <td id="netSalaryDisplay">0.00</td>
                        </tr>
                    </tbody>
                </table>
                
                <table class="deduction-table">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Employer</th>
                            <th>Employee</th>
                            <th>Sub-Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>EPF</td>
                            <td id="epfEmployer">0.00</td>
                            <td id="epfEmployee">0.00</td>
                            <td id="epfTotal">0.00</td>
                        </tr>
                        <tr>
                            <td>SOCSO</td>
                            <td id="socsoEmployer">0.00</td>
                            <td id="socsoEmployee">0.00</td>
                            <td id="socsoTotal">0.00</td>
                        </tr>
                        <tr>
                            <td>EIS</td>
                            <td id="eisEmployer">0.00</td>
                            <td id="eisEmployee">0.00</td>
                            <td id="eisTotal">0.00</td>
                        </tr>
                        <tr>
                            <td>Tax</td>
                            <td>0.00</td>
                            <td id="taxEmployee">0.00</td>
                            <td id="taxTotal">0.00</td>
                        </tr>
                        <tr class="total-row">
                            <td>Total</td>
                            <td id="totalEmployer">0.00</td>
                            <td id="totalEmployee">0.00</td>
                            <td id="totalAll">0.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Tax Explanation Section -->
            <div class="tax-explanation">
                <div class="tax-explanation-header">
                    <i class="fas fa-info-circle"></i>
                    <h3>How EPF, PCB, SOCSO, and EIS are Calculated</h3>
                </div>
                
                <div class="tax-cards">
                    <div class="tax-card">
                        <div class="tax-card-header">
                            <div class="tax-icon epf-icon">
                                <i class="fas fa-piggy-bank"></i>
                            </div>
                            <div>
                                <div class="tax-title">EPF (KWSP / Kumpulan Wang Simpanan Pekerja)</div>
                                <div class="tax-subtitle">Retirement Savings Contribution (Mandatory)</div>
                            </div>
                        </div>
                        <div class="tax-description">
                            EPF is a compulsory retirement saving scheme in Malaysia. Every month, both employee and employer contribute a portion of the employee’s monthly wages into the EPF account.
                        </div>
                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Formula</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                Employee EPF = Monthly Salary × 11%<br><br>
                                Employer EPF =<br>
                                &nbsp;&nbsp;• Monthly Salary × 13% (if salary ≤ RM 5,000)<br>
                                &nbsp;&nbsp;• Monthly Salary × 12% (if salary > RM 5,000)<br><br>
                                Total EPF = Employee EPF + Employer EPF<br>
                                Net Salary = Monthly Salary − Employee EPF
                            </div>
                        </div>

                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Example</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                Monthly Salary: RM 5,000<br>
                                Employee EPF (11%): RM 550<br>
                                Employer EPF (13%): RM 650<br>
                                <strong>Total EPF Contribution: RM 1,200</strong>
                            </div>
                        </div>
                        <div class="tax-note">
                            Note: EPF (KWSP) follows Jadual Ketiga wage-band table (Employer / Employee amounts).
                        </div>
                    </div>

                    <div class="tax-card">
                        <div class="tax-card-header">
                            <div class="tax-icon pcb-icon">
                                <i class="fas fa-receipt"></i>
                            </div>
                            <div>
                                <div class="tax-title">PCB (Potongan Cukai Berjadual)</div>
                                <div class="tax-subtitle">Monthly Tax Deduction</div>
                            </div>
                        </div>
                        <div class="tax-description">
                            PCB is calculated based on your monthly taxable income after EPF deductions. The calculation follows Malaysia's progressive tax rates, which range from 0% to 30% depending on your annual income bracket.
                        </div>
                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Formula</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                PCB = (Annual Taxable Income × Tax Rate - Relief) ÷ 12
                            </div>
                        </div>

                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Example</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                Monthly Salary: RM 5,000<br>
                                Annual Income: RM 60,000<br>
                                After EPF (11%): RM 53,400<br>
                                PCB Rate: 11% (RM 35,001 - RM 50,000 bracket)<br>
                                <strong>Monthly PCB: ~RM 247</strong>
                            </div>
                        </div>
                        <div class="tax-note">
                            Note: PCB is deducted monthly and may be adjusted at year-end when filing actual tax returns.
                        </div>
                    </div>
                    
                    <div class="tax-card">
                        <div class="tax-card-header">
                            <div class="tax-icon socso-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div>
                                <div class="tax-title">SOCSO (Social Security)</div>
                                <div class="tax-subtitle">Employee Protection Scheme</div>
                            </div>
                        </div>
                        <div class="tax-description">
                            SOCSO provides social protection for employees in case of work-related accidents, disability, or death. The contribution is calculated based on your monthly salary with specific rate tiers.
                        </div>
                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Formula</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                SOCSO = Monthly Salary × Rate (0.5% for RM 4,000 and below)
                            </div>
                        </div>

                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Example</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                Monthly Salary: RM 5,000<br>
                                Employee Rate: 0.5% (capped at RM 4,000)<br>
                                Employer Rate: 1.75% (capped at RM 4,000)<br>
                                <strong>Employee SOCSO: RM 20.00</strong><br>
                                <strong>Employer SOCSO: RM 70.00</strong>
                            </div>
                        </div>
                        <div class="tax-note">
                            Note: SOCSO contributions are capped at RM 4,000 monthly salary for calculation purposes.
                        </div>
                    </div>
                    
                    <div class="tax-card">
                        <div class="tax-card-header">
                            <div class="tax-icon eis-icon">
                                <i class="fas fa-umbrella"></i>
                            </div>
                            <div>
                                <div class="tax-title">EIS (Employment Insurance)</div>
                                <div class="tax-subtitle">Unemployment Protection</div>
                            </div>
                        </div>
                        <div class="tax-description">
                            EIS provides financial assistance and support for employees who lose their jobs. It's a mandatory contribution for most Malaysian employees, calculated as a percentage of monthly salary.
                        </div>
                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Formula</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                EIS = Monthly Salary × 0.2% (capped at RM 4,000)
                            </div>
                        </div>

                        <div class="tax-collapsible">
                            <div class="tax-collapsible-header" onclick="toggleTaxCollapsible(this)">
                                <span>Example</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="tax-collapsible-content">
                                Monthly Salary: RM 5,000<br>
                                Employee Rate: 0.2% (capped at RM 4,000)<br>
                                Employer Rate: 0.2% (capped at RM 4,000)<br>
                                <strong>Employee EIS: RM 8.00</strong><br>
                                <strong>Employer EIS: RM 8.00</strong>
                            </div>
                        </div>
                        <div class="tax-note">
                            Note: EIS provides up to 6 months of financial assistance and job search support for eligible claimants.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Housing Loan Calculator Tab -->
        <div id="housing-loan-tab" class="tab-content">
            <div class="loan-calculator-container">
                <!-- Input Section -->
                <div class="input-section">
                    <div class="input-grid">
                        <div class="input-group">
                            <label><i class="fas fa-wallet"></i>Monthly Income (RM)</label>
                            <input type="number" id="monthlyIncome" value="5000" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-home"></i>Property Price (RM)</label>
                            <input type="number" id="propertyPrice" value="300000" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-clock"></i>Loan Tenure (Years)</label>
                            <input type="number" id="loanTenure" value="30" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-percentage"></i>Interest Rate (%)</label>
                            <input type="number" id="interestRate" value="4.5" step="0.1" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-hand-holding-usd"></i>Downpayment (%)</label>
                            <input type="number" id="downpaymentPercent" value="10" step="1" min="0" max="100" />
                        </div>
                    </div>
                </div>

                <!-- Other Monthly Commitments Section -->
                <div class="input-section">
                    <h3>Other Monthly Commitments</h3>
                    <div class="input-grid">
                        <div class="input-group">
                            <label><i class="fas fa-car"></i>Car Loan (RM)</label>
                            <input type="number" id="carLoan" value="0" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-graduation-cap"></i>PTPTN (RM)</label>
                            <input type="number" id="ptptn" value="0" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-credit-card"></i>Credit Card (RM)</label>
                            <input type="number" id="creditCard" value="0" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-user-circle"></i>Personal Loan (RM)</label>
                            <input type="number" id="personalLoan" value="0" />
                        </div>

                        <div class="input-group">
                            <label><i class="fas fa-ellipsis-h"></i>Others (RM)</label>
                            <input type="number" id="otherCommitments" value="0" />
                        </div>
                    </div>
                    <div class="summary-item mt-4 column">
                        <div class="summary-row">
                            <span>Existing Monthly Commitments:</span>
                            <span class="summary-value" id="existingCommitmentsDisplay">RM 0.00</span>
                        </div>
                        <div id="commitmentsBreakdown" class="commitment-breakdown">
                            <!-- Breakdown items will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="loan-buttons">
                    <button class="btn btn-primary" onclick="calculateHousingLoan()">
                        <i class="fas fa-calculator"></i>Calculate Affordability
                    </button>
                    <button class="btn btn-secondary" onclick="resetHousingLoan()">
                        <i class="fas fa-redo"></i>Reset
                    </button>
                </div>

                <!-- Results Section (Hidden by default) -->
                <div id="loanResults" class="hidden">
                    <div class="loan-result-cards">
                        <div class="loan-result-card">
                            <h4><i class="fas fa-money-bill-wave"></i>Monthly Repayment</h4>
                            <div class="loan-result-value" id="monthlyRepaymentDisplay">RM 0</div>
                            <div class="loan-result-description">For a loan of RM <span id="loanAmountDisplay">0</span></div>
                        </div>
                        <div class="loan-result-card">
                            <h4><i class="fas fa-chart-pie"></i>DSR Score</h4>
                            <div class="loan-result-value" id="dsrScoreDisplay">0%</div>
                            <div class="loan-result-description" id="dsrStatusDisplay">Status</div>
                        </div>
                        <div class="loan-result-card">
                            <h4><i class="fas fa-calculator"></i>Total Monthly Commitments</h4>
                            <div class="loan-result-value" id="totalCommitmentsDisplay">RM 0</div>
                            <div class="loan-result-description">Existing + new loan repayment</div>
                        </div>
                    </div>

                    <!-- Upfront Cost Breakdown Section -->
                    <div class="upfront-cost-section">
                        <div class="upfront-cost-header">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-receipt h-6 w-6 text-primary">
                                <path d="M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z"></path>
                                <path d="M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8"></path>
                                <path d="M12 17.5v-11"></path>
                            </svg>
                            <h3>Detailed Upfront Cost Breakdown</h3>
                        </div>
                        
                        <div class="upfront-cost-tabs">
                            <div class="upfront-cost-tab active" onclick="openUpfrontCostTab(event, 'new-property')">
                                <i class="fas fa-building"></i>New Property
                            </div>
                            <div class="upfront-cost-tab" onclick="openUpfrontCostTab(event, 'subsale')">
                                <i class="fas fa-home"></i>Subsale
                            </div>
                        </div>
                        
                        <div id="new-property" class="upfront-cost-content active">
                            <div class="upfront-cost-grid">
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-hand-holding-usd"></i>
                                            Downpayment
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="newDownpaymentPercent" value="10" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('new')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newDownpaymentAmount">RM 0</div>
                                        <div class="cost-description">Initial payment made when purchasing a property</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-file-contract"></i>
                                            S&P Legal Fee
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="newSpLegalFeePercent" value="1" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('new')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newSpLegalFeeAmount">RM 0</div>
                                        <div class="cost-description">Legal fees for Sale and Purchase Agreement</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-stamp"></i>
                                            Stamp Duty
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="newStampDutyPercent" value="2" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('new')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newStampDutyAmount">RM 0</div>
                                        <div class="cost-description">Tax on property transfer documents</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-gavel"></i>
                                            Loan Legal Fee
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="newLoanLegalFeePercent" value="1" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('new')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newLoanLegalFeeAmount">RM 0</div>
                                        <div class="cost-description">Legal fees for loan agreement preparation</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-file-invoice-dollar"></i>
                                            Loan Stamp Duty
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="newLoanStampDutyPercent" value="0.5" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('new')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newLoanStampDutyAmount">RM 0</div>
                                        <div class="cost-description">Tax on loan agreement documents</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card total-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-calculator"></i>
                                            Total Upfront Cost
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="newTotalUpfrontCostAmount">RM 0</div>
                                        <div class="cost-description">Sum of all upfront costs</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="fee-explanation">
                                <div class="fee-explanation-header">
                                    <i class="fas fa-info-circle"></i>
                                    <h4>Fee Explanations</h4>
                                </div>
                                <div class="fee-cards">
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-file-contract"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">S&P Legal Fee (~1%)</div>
                                            <div class="fee-description">Based on Bar Council scale. Developer often covers this for new projects.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-stamp"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">MOT Stamp Duty (~2%)</div>
                                            <div class="fee-description">Government tiered rates, 2–3% typical. Sometimes waived for first-home buyers in new projects.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-gavel"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">Loan Legal Fee (~0.8–1%)</div>
                                            <div class="fee-description">Legal work for loan documents. Sometimes free in new launches.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-file-invoice-dollar"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">Loan Stamp Duty (0.5%)</div>
                                            <div class="fee-description">Fixed at 0.5% of loan amount.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="fee-note">
                                    <i class="fas fa-lightbulb"></i>
                                    <div class="fee-note-content">
                                        <div class="fee-note-title">Important Note</div>
                                        <div class="fee-note-text">Total costs usually range from 3.5%–5% of property price. For new projects, developers often absorb S&P Legal Fee, Loan Legal Fee, or MOT.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="subsale" class="upfront-cost-content">
                            <div class="upfront-cost-grid">
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-hand-holding-usd"></i>
                                            Downpayment
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleDownpaymentPercent" value="10" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleDownpaymentAmount">RM 0</div>
                                        <div class="cost-description">Initial payment made when purchasing a property</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-file-contract"></i>
                                            S&P Legal Fee
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleSpLegalFeePercent" value="1" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleSpLegalFeeAmount">RM 0</div>
                                        <div class="cost-description">Legal fees for Sale and Purchase Agreement</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-stamp"></i>
                                            MOT
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleMotPercent" value="3" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleMotAmount">RM 0</div>
                                        <div class="cost-description">Memorandum of Transfer fee for property title transfer</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-gavel"></i>
                                            Loan Legal Fee
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleLoanLegalFeePercent" value="1" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleLoanLegalFeeAmount">RM 0</div>
                                        <div class="cost-description">Legal fees for loan agreement preparation</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-file-invoice-dollar"></i>
                                            Loan Stamp Duty
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleLoanStampDutyPercent" value="0.5" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleLoanStampDutyAmount">RM 0</div>
                                        <div class="cost-description">Tax on loan agreement documents</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-calculator"></i>
                                            Valuation Fee
                                        </div>
                                        <div class="cost-percentage">
                                            <input type="number" id="subsaleValuationFeePercent" value="0.25" step="0.1" min="0" max="100" onchange="updateUpfrontCosts('subsale')">
                                            <span>%</span>
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleValuationFeeAmount">RM 0</div>
                                        <div class="cost-description">Property valuation fee required for loan approval</div>
                                    </div>
                                </div>
                                
                                <div class="upfront-cost-card total-cost-card">
                                    <div class="cost-card-header">
                                        <div class="cost-card-title">
                                            <i class="fas fa-calculator"></i>
                                            Total Upfront Cost
                                        </div>
                                    </div>
                                    <div class="cost-card-body">
                                        <div class="cost-amount" id="subsaleTotalUpfrontCostAmount">RM 0</div>
                                        <div class="cost-description">Sum of all upfront costs</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="fee-explanation">
                                <div class="fee-explanation-header">
                                    <i class="fas fa-info-circle"></i>
                                    <h4>Fee Explanations</h4>
                                </div>
                                <div class="fee-cards">
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-file-contract"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">S&P Legal Fee (~1%)</div>
                                            <div class="fee-description">Based on Bar Council scale. Developer often covers this for new projects.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-stamp"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">MOT Stamp Duty (~2%)</div>
                                            <div class="fee-description">Government tiered rates, 2–3% typical. Sometimes waived for first-home buyers in new projects.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-gavel"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">Loan Legal Fee (~0.8–1%)</div>
                                            <div class="fee-description">Legal work for loan documents. Sometimes free in new launches.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-file-invoice-dollar"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">Loan Stamp Duty (0.5%)</div>
                                            <div class="fee-description">Fixed at 0.5% of loan amount.</div>
                                        </div>
                                    </div>
                                    <div class="fee-card">
                                        <div class="fee-icon">
                                            <i class="fas fa-calculator"></i>
                                        </div>
                                        <div class="fee-details">
                                            <div class="fee-name">Valuation Fee (0.1–0.3% subsale only)</div>
                                            <div class="fee-description">Required for bank loan approval on subsale properties.</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="fee-note">
                                    <i class="fas fa-lightbulb"></i>
                                    <div class="fee-note-content">
                                        <div class="fee-note-title">Important Note</div>
                                        <div class="fee-note-text">Total costs usually range from 3.5%–5% of property price. For new projects, developers often absorb S&P Legal Fee, Loan Legal Fee, or MOT.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer>
        <div class="footer-content">
            <p>&copy; <span id="currentYear"></span> Financial Calculators by Jackie Low. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="pcb_table.js"></script>
    <script>
        // Set current year for copyright
        document.getElementById('currentYear').textContent = new Date().getFullYear();
        
        let chartInstance = null;

        // Tab functionality
        function openTab(evt, tabName) {
            // Hide all tab content
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            // Remove active class from all tabs
            const tabs = document.getElementsByClassName("tab");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }
            
            // Show specific tab content
            document.getElementById(tabName).classList.add("active");
            
            // Add active class to button that opened tab
            evt.currentTarget.classList.add("active");
        }

        // Upfront Cost Tab functionality
        function openUpfrontCostTab(evt, tabName) {
            // Hide all tab content
            const tabContents = document.getElementsByClassName("upfront-cost-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            // Remove active class from all tabs
            const tabs = document.getElementsByClassName("upfront-cost-tab");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }
            
            // Show specific tab content
            document.getElementById(tabName).classList.add("active");
            
            // Add active class to button that opened tab
            evt.currentTarget.classList.add("active");
        }

        // Tax Card Collapsible functionality
        function toggleTaxCollapsible(headerElement) {
            // Toggle active class on the container
            const container = headerElement.parentElement;
            container.classList.toggle('active');
            
            // Toggle visibility of content
            const content = headerElement.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        }

        function formatCurrency(value) {
            return `RM ${parseFloat(value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}`;
        }

        // Compound Interest Calculator Functions
        function calculateCompoundInterest() {
            const initialAmount = parseFloat(document.getElementById('initialAmount').value) || 0;
            const monthlyContribution = parseFloat(document.getElementById('monthlyContribution').value) || 0;
            const annualTopup = parseFloat(document.getElementById('annualTopup').value) || 0;
            const annualInterestRate = parseFloat(document.getElementById('annualInterestRate').value) || 0;
            const yearsLength = parseInt(document.getElementById('yearsLength').value) || 1;

            const results = [];
            let balance = initialAmount;
            const monthlyRate = annualInterestRate / 100 / 12;
            let totalContributedSoFar = initialAmount;

            for (let year = 1; year <= yearsLength; year++) {
                // Monthly contribution increases by Annual Topup each year
                const monthlyContributionThisYear = monthlyContribution + annualTopup * (year - 1);
                const totalContributionThisYear = monthlyContributionThisYear * 12;

                // Add monthly contributions throughout the year and apply monthly interest
                for (let month = 1; month <= 12; month++) {
                    balance += monthlyContributionThisYear;
                    totalContributedSoFar += monthlyContributionThisYear;
                    balance *= (1 + monthlyRate);
                }

                const interestEarned = balance - totalContributedSoFar;
                const totalAmount = balance;

                results.push({
                    year,
                    monthlyContribution: monthlyContributionThisYear.toFixed(2),
                    totalContribution: totalContributionThisYear.toFixed(2),
                    interestEarned: interestEarned.toFixed(2),
                    totalInvested: totalContributedSoFar.toFixed(2),
                    totalAmount: totalAmount.toFixed(2),
                });
            }

            return results;
        }

        function updateCompoundInterestDisplay() {
            const results = calculateCompoundInterest();

            // Update summary
            if (results.length > 0) {
                const finalData = results[results.length - 1];
                document.getElementById('totalInvestedSummary').textContent = formatCurrency(finalData.totalInvested);
                document.getElementById('interestEarnedSummary').textContent = formatCurrency(finalData.interestEarned);
                document.getElementById('totalAmountSummary').textContent = formatCurrency(finalData.totalAmount);
            }

            // Update table
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            results.forEach((row) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${row.year}</td>
                    <td>${formatCurrency(row.monthlyContribution)}</td>
                    <td>${formatCurrency(row.totalContribution)}</td>
                    <td>${formatCurrency(row.interestEarned)}</td>
                    <td>${formatCurrency(row.totalInvested)}</td>
                    <td>${formatCurrency(row.totalAmount)}</td>
                `;
                tableBody.appendChild(tr);
            });

            // Update chart
            updateChart(results);
        }

        function updateChart(results) {
            const ctx = document.getElementById('myChart').getContext('2d');
            
            if (chartInstance) {
                chartInstance.destroy();
            }

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: results.map(r => `Year ${r.year}`),
                    datasets: [
                        {
                            label: 'Total Invested',
                            data: results.map(r => parseFloat(r.totalInvested)),
                            borderColor: '#FF9800',
                            backgroundColor: 'rgba(255, 152, 0, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#FF9800',
                            pointBorderColor: '#FF9800',
                            pointRadius: 4,
                            pointHoverRadius: 6,
                        },
                        {
                            label: 'Total Amount',
                            data: results.map(r => parseFloat(r.totalAmount)),
                            borderColor: '#4CAF50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#4CAF50',
                            pointBorderColor: '#4CAF50',
                            pointRadius: 4,
                            pointHoverRadius: 6,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                boxWidth: 12,
                                padding: 10,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: '#fff',
                            titleColor: '#000',
                            bodyColor: '#000',
                            borderColor: '#ccc',
                            borderWidth: 1,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += 'RM ' + parseFloat(context.parsed.y).toLocaleString('en-MY', { maximumFractionDigits: 0 });
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'RM ' + (value / 1000000).toFixed(1) + 'M';
                                },
                                font: {
                                    size: 11
                                }
                            },
                            x: {
                                ticks: {
                                    font: {
                                        size: 11
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        // Tax & Statutory Contributions (calibrated to your screenshots + EPF Jadual Ketiga table)
        const EPF_TABLE = [{"min":10.01,"max":20.0,"employer":3.0,"employee":3.0,"total":6.0},{"min":20.01,"max":40.0,"employer":6.0,"employee":5.0,"total":11.0},{"min":40.01,"max":60.0,"employer":8.0,"employee":7.0,"total":15.0},{"min":60.01,"max":80.0,"employer":11.0,"employee":9.0,"total":20.0},{"min":80.01,"max":100.0,"employer":13.0,"employee":11.0,"total":24.0},{"min":100.01,"max":120.0,"employer":16.0,"employee":14.0,"total":30.0},{"min":120.01,"max":140.0,"employer":19.0,"employee":16.0,"total":35.0},{"min":140.01,"max":160.0,"employer":21.0,"employee":18.0,"total":39.0},{"min":160.01,"max":180.0,"employer":24.0,"employee":20.0,"total":44.0},{"min":180.01,"max":200.0,"employer":26.0,"employee":22.0,"total":48.0},{"min":200.01,"max":220.0,"employer":29.0,"employee":25.0,"total":54.0},{"min":220.01,"max":240.0,"employer":32.0,"employee":27.0,"total":59.0},{"min":240.01,"max":260.0,"employer":34.0,"employee":29.0,"total":63.0},{"min":260.01,"max":280.0,"employer":37.0,"employee":31.0,"total":68.0},{"min":280.01,"max":300.0,"employer":39.0,"employee":33.0,"total":72.0},{"min":300.01,"max":320.0,"employer":42.0,"employee":36.0,"total":78.0},{"min":320.01,"max":340.0,"employer":45.0,"employee":38.0,"total":83.0},{"min":340.01,"max":360.0,"employer":47.0,"employee":40.0,"total":87.0},{"min":360.01,"max":380.0,"employer":50.0,"employee":42.0,"total":92.0},{"min":380.01,"max":400.0,"employer":52.0,"employee":44.0,"total":96.0},{"min":400.01,"max":420.0,"employer":55.0,"employee":47.0,"total":102.0},{"min":420.01,"max":440.0,"employer":58.0,"employee":49.0,"total":107.0},{"min":440.01,"max":460.0,"employer":60.0,"employee":51.0,"total":111.0},{"min":460.01,"max":480.0,"employer":63.0,"employee":53.0,"total":116.0},{"min":480.01,"max":500.0,"employer":65.0,"employee":55.0,"total":120.0},{"min":500.01,"max":520.0,"employer":68.0,"employee":58.0,"total":126.0},{"min":520.01,"max":540.0,"employer":71.0,"employee":60.0,"total":131.0},{"min":540.01,"max":560.0,"employer":73.0,"employee":62.0,"total":135.0},{"min":560.01,"max":580.0,"employer":76.0,"employee":64.0,"total":140.0},{"min":580.01,"max":600.0,"employer":78.0,"employee":66.0,"total":144.0},{"min":600.01,"max":620.0,"employer":81.0,"employee":69.0,"total":150.0},{"min":620.01,"max":640.0,"employer":84.0,"employee":71.0,"total":155.0},{"min":640.01,"max":660.0,"employer":86.0,"employee":73.0,"total":159.0},{"min":660.01,"max":680.0,"employer":89.0,"employee":75.0,"total":164.0},{"min":680.01,"max":700.0,"employer":91.0,"employee":77.0,"total":168.0},{"min":700.01,"max":720.0,"employer":94.0,"employee":80.0,"total":174.0},{"min":720.01,"max":740.0,"employer":97.0,"employee":82.0,"total":179.0},{"min":740.01,"max":760.0,"employer":99.0,"employee":84.0,"total":183.0},{"min":760.01,"max":780.0,"employer":102.0,"employee":86.0,"total":188.0},{"min":780.01,"max":800.0,"employer":104.0,"employee":88.0,"total":192.0},{"min":800.01,"max":820.0,"employer":107.0,"employee":91.0,"total":198.0},{"min":820.01,"max":840.0,"employer":110.0,"employee":93.0,"total":203.0},{"min":840.01,"max":860.0,"employer":112.0,"employee":95.0,"total":207.0},{"min":860.01,"max":880.0,"employer":115.0,"employee":97.0,"total":212.0},{"min":880.01,"max":900.0,"employer":117.0,"employee":99.0,"total":216.0},{"min":900.01,"max":920.0,"employer":120.0,"employee":102.0,"total":222.0},{"min":920.01,"max":940.0,"employer":123.0,"employee":104.0,"total":227.0},{"min":940.01,"max":960.0,"employer":125.0,"employee":106.0,"total":231.0},{"min":960.01,"max":980.0,"employer":128.0,"employee":108.0,"total":236.0},{"min":980.01,"max":1000.0,"employer":130.0,"employee":110.0,"total":240.0},{"min":1000.01,"max":1020.0,"employer":133.0,"employee":113.0,"total":246.0},{"min":1020.01,"max":1040.0,"employer":136.0,"employee":115.0,"total":251.0},{"min":1040.01,"max":1060.0,"employer":138.0,"employee":117.0,"total":255.0},{"min":1060.01,"max":1080.0,"employer":141.0,"employee":119.0,"total":260.0},{"min":1080.01,"max":1100.0,"employer":143.0,"employee":121.0,"total":264.0},{"min":1100.01,"max":1120.0,"employer":146.0,"employee":124.0,"total":270.0},{"min":1120.01,"max":1140.0,"employer":149.0,"employee":126.0,"total":275.0},{"min":1140.01,"max":1160.0,"employer":151.0,"employee":128.0,"total":279.0},{"min":1160.01,"max":1180.0,"employer":154.0,"employee":130.0,"total":284.0},{"min":1180.01,"max":1200.0,"employer":156.0,"employee":132.0,"total":288.0},{"min":1200.01,"max":1220.0,"employer":159.0,"employee":135.0,"total":294.0},{"min":1220.01,"max":1240.0,"employer":162.0,"employee":137.0,"total":299.0},{"min":1240.01,"max":1260.0,"employer":164.0,"employee":139.0,"total":303.0},{"min":1260.01,"max":1280.0,"employer":167.0,"employee":141.0,"total":308.0},{"min":1280.01,"max":1300.0,"employer":169.0,"employee":143.0,"total":312.0},{"min":1300.01,"max":1320.0,"employer":172.0,"employee":146.0,"total":318.0},{"min":1320.01,"max":1340.0,"employer":175.0,"employee":148.0,"total":323.0},{"min":1340.01,"max":1360.0,"employer":177.0,"employee":150.0,"total":327.0},{"min":1360.01,"max":1380.0,"employer":180.0,"employee":152.0,"total":332.0},{"min":1380.01,"max":1400.0,"employer":182.0,"employee":154.0,"total":336.0},{"min":1400.01,"max":1420.0,"employer":185.0,"employee":157.0,"total":342.0},{"min":1420.01,"max":1440.0,"employer":188.0,"employee":159.0,"total":347.0},{"min":1440.01,"max":1460.0,"employer":190.0,"employee":161.0,"total":351.0},{"min":1460.01,"max":1480.0,"employer":193.0,"employee":163.0,"total":356.0},{"min":1480.01,"max":1500.0,"employer":195.0,"employee":165.0,"total":360.0},{"min":1500.01,"max":1520.0,"employer":198.0,"employee":168.0,"total":366.0},{"min":1520.01,"max":1540.0,"employer":201.0,"employee":170.0,"total":371.0},{"min":1540.01,"max":1560.0,"employer":203.0,"employee":172.0,"total":375.0},{"min":1560.01,"max":1580.0,"employer":206.0,"employee":174.0,"total":380.0},{"min":1580.01,"max":1600.0,"employer":208.0,"employee":176.0,"total":384.0},{"min":1600.01,"max":1620.0,"employer":211.0,"employee":179.0,"total":390.0},{"min":1620.01,"max":1640.0,"employer":214.0,"employee":181.0,"total":395.0},{"min":1640.01,"max":1660.0,"employer":216.0,"employee":183.0,"total":399.0},{"min":1660.01,"max":1680.0,"employer":219.0,"employee":185.0,"total":404.0},{"min":1680.01,"max":1700.0,"employer":221.0,"employee":187.0,"total":408.0},{"min":1700.01,"max":1720.0,"employer":224.0,"employee":190.0,"total":414.0},{"min":1720.01,"max":1740.0,"employer":227.0,"employee":192.0,"total":419.0},{"min":1740.01,"max":1760.0,"employer":229.0,"employee":194.0,"total":423.0},{"min":1760.01,"max":1780.0,"employer":232.0,"employee":196.0,"total":428.0},{"min":1780.01,"max":1800.0,"employer":234.0,"employee":198.0,"total":432.0},{"min":1800.01,"max":1820.0,"employer":237.0,"employee":201.0,"total":438.0},{"min":1820.01,"max":1840.0,"employer":240.0,"employee":203.0,"total":443.0},{"min":1840.01,"max":1860.0,"employer":242.0,"employee":205.0,"total":447.0},{"min":1860.01,"max":1880.0,"employer":245.0,"employee":207.0,"total":452.0},{"min":1880.01,"max":1900.0,"employer":247.0,"employee":209.0,"total":456.0},{"min":1900.01,"max":1920.0,"employer":250.0,"employee":212.0,"total":462.0},{"min":1920.01,"max":1940.0,"employer":253.0,"employee":214.0,"total":467.0},{"min":1940.01,"max":1960.0,"employer":255.0,"employee":216.0,"total":471.0},{"min":1960.01,"max":1980.0,"employer":258.0,"employee":218.0,"total":476.0},{"min":1980.01,"max":2000.0,"employer":260.0,"employee":220.0,"total":480.0},{"min":2000.01,"max":2020.0,"employer":263.0,"employee":223.0,"total":486.0},{"min":2020.01,"max":2040.0,"employer":266.0,"employee":225.0,"total":491.0},{"min":2040.01,"max":2060.0,"employer":268.0,"employee":227.0,"total":495.0},{"min":2060.01,"max":2080.0,"employer":271.0,"employee":229.0,"total":500.0},{"min":2080.01,"max":2100.0,"employer":273.0,"employee":231.0,"total":504.0},{"min":2100.01,"max":2120.0,"employer":276.0,"employee":234.0,"total":510.0},{"min":2120.01,"max":2140.0,"employer":279.0,"employee":236.0,"total":515.0},{"min":2140.01,"max":2160.0,"employer":281.0,"employee":238.0,"total":519.0},{"min":2160.01,"max":2180.0,"employer":284.0,"employee":240.0,"total":524.0},{"min":2180.01,"max":2200.0,"employer":286.0,"employee":242.0,"total":528.0},{"min":2200.01,"max":2220.0,"employer":289.0,"employee":245.0,"total":534.0},{"min":2220.01,"max":2240.0,"employer":292.0,"employee":247.0,"total":539.0},{"min":2240.01,"max":2260.0,"employer":294.0,"employee":249.0,"total":543.0},{"min":2260.01,"max":2280.0,"employer":297.0,"employee":251.0,"total":548.0},{"min":2280.01,"max":2300.0,"employer":299.0,"employee":253.0,"total":552.0},{"min":2300.01,"max":2320.0,"employer":302.0,"employee":256.0,"total":558.0},{"min":2320.01,"max":2340.0,"employer":305.0,"employee":258.0,"total":563.0},{"min":2340.01,"max":2360.0,"employer":307.0,"employee":260.0,"total":567.0},{"min":2360.01,"max":2380.0,"employer":310.0,"employee":262.0,"total":572.0},{"min":2380.01,"max":2400.0,"employer":312.0,"employee":264.0,"total":576.0},{"min":2400.01,"max":2420.0,"employer":315.0,"employee":267.0,"total":582.0},{"min":2420.01,"max":2440.0,"employer":318.0,"employee":269.0,"total":587.0},{"min":2440.01,"max":2460.0,"employer":320.0,"employee":271.0,"total":591.0},{"min":2460.01,"max":2480.0,"employer":323.0,"employee":273.0,"total":596.0},{"min":2480.01,"max":2500.0,"employer":325.0,"employee":275.0,"total":600.0},{"min":2500.01,"max":2520.0,"employer":328.0,"employee":278.0,"total":606.0},{"min":2520.01,"max":2540.0,"employer":331.0,"employee":280.0,"total":611.0},{"min":2540.01,"max":2560.0,"employer":333.0,"employee":282.0,"total":615.0},{"min":2560.01,"max":2580.0,"employer":336.0,"employee":284.0,"total":620.0},{"min":2580.01,"max":2600.0,"employer":338.0,"employee":286.0,"total":624.0},{"min":2600.01,"max":2620.0,"employer":341.0,"employee":289.0,"total":630.0},{"min":2620.01,"max":2640.0,"employer":344.0,"employee":291.0,"total":635.0},{"min":2640.01,"max":2660.0,"employer":346.0,"employee":293.0,"total":639.0},{"min":2660.01,"max":2680.0,"employer":349.0,"employee":295.0,"total":644.0},{"min":2680.01,"max":2700.0,"employer":351.0,"employee":297.0,"total":648.0},{"min":2700.01,"max":2720.0,"employer":354.0,"employee":300.0,"total":654.0},{"min":2720.01,"max":2740.0,"employer":357.0,"employee":302.0,"total":659.0},{"min":2740.01,"max":2760.0,"employer":359.0,"employee":304.0,"total":663.0},{"min":2760.01,"max":2780.0,"employer":362.0,"employee":306.0,"total":668.0},{"min":2780.01,"max":2800.0,"employer":364.0,"employee":308.0,"total":672.0},{"min":2800.01,"max":2820.0,"employer":367.0,"employee":311.0,"total":678.0},{"min":2820.01,"max":2840.0,"employer":370.0,"employee":313.0,"total":683.0},{"min":2840.01,"max":2860.0,"employer":372.0,"employee":315.0,"total":687.0},{"min":2860.01,"max":2880.0,"employer":375.0,"employee":317.0,"total":692.0},{"min":2880.01,"max":2900.0,"employer":377.0,"employee":319.0,"total":696.0},{"min":2900.01,"max":2920.0,"employer":380.0,"employee":322.0,"total":702.0},{"min":2920.01,"max":2940.0,"employer":383.0,"employee":324.0,"total":707.0},{"min":2940.01,"max":2960.0,"employer":385.0,"employee":326.0,"total":711.0},{"min":2960.01,"max":2980.0,"employer":388.0,"employee":328.0,"total":716.0},{"min":2980.01,"max":3000.0,"employer":390.0,"employee":330.0,"total":720.0},{"min":3000.01,"max":3020.0,"employer":393.0,"employee":333.0,"total":726.0},{"min":3020.01,"max":3040.0,"employer":396.0,"employee":335.0,"total":731.0},{"min":3040.01,"max":3060.0,"employer":398.0,"employee":337.0,"total":735.0},{"min":3060.01,"max":3080.0,"employer":401.0,"employee":339.0,"total":740.0},{"min":3080.01,"max":3100.0,"employer":403.0,"employee":341.0,"total":744.0},{"min":3100.01,"max":3120.0,"employer":406.0,"employee":344.0,"total":750.0},{"min":3120.01,"max":3140.0,"employer":409.0,"employee":346.0,"total":755.0},{"min":3140.01,"max":3160.0,"employer":411.0,"employee":348.0,"total":759.0},{"min":3160.01,"max":3180.0,"employer":414.0,"employee":350.0,"total":764.0},{"min":3180.01,"max":3200.0,"employer":416.0,"employee":352.0,"total":768.0},{"min":3200.01,"max":3220.0,"employer":419.0,"employee":355.0,"total":774.0},{"min":3220.01,"max":3240.0,"employer":422.0,"employee":357.0,"total":779.0},{"min":3240.01,"max":3260.0,"employer":424.0,"employee":359.0,"total":783.0},{"min":3260.01,"max":3280.0,"employer":427.0,"employee":361.0,"total":788.0},{"min":3280.01,"max":3300.0,"employer":429.0,"employee":363.0,"total":792.0},{"min":3300.01,"max":3320.0,"employer":432.0,"employee":366.0,"total":798.0},{"min":3320.01,"max":3340.0,"employer":435.0,"employee":368.0,"total":803.0},{"min":3340.01,"max":3360.0,"employer":437.0,"employee":370.0,"total":807.0},{"min":3360.01,"max":3380.0,"employer":440.0,"employee":372.0,"total":812.0},{"min":3380.01,"max":3400.0,"employer":442.0,"employee":374.0,"total":816.0},{"min":3400.01,"max":3420.0,"employer":445.0,"employee":377.0,"total":822.0},{"min":3420.01,"max":3440.0,"employer":448.0,"employee":379.0,"total":827.0},{"min":3440.01,"max":3460.0,"employer":450.0,"employee":381.0,"total":831.0},{"min":3460.01,"max":3480.0,"employer":453.0,"employee":383.0,"total":836.0},{"min":3480.01,"max":3500.0,"employer":455.0,"employee":385.0,"total":840.0},{"min":3500.01,"max":3520.0,"employer":458.0,"employee":388.0,"total":846.0},{"min":3520.01,"max":3540.0,"employer":461.0,"employee":390.0,"total":851.0},{"min":3540.01,"max":3560.0,"employer":463.0,"employee":392.0,"total":855.0},{"min":3560.01,"max":3580.0,"employer":466.0,"employee":394.0,"total":860.0},{"min":3580.01,"max":3600.0,"employer":468.0,"employee":396.0,"total":864.0},{"min":3600.01,"max":3620.0,"employer":471.0,"employee":399.0,"total":870.0},{"min":3620.01,"max":3640.0,"employer":474.0,"employee":401.0,"total":875.0},{"min":3640.01,"max":3660.0,"employer":476.0,"employee":403.0,"total":879.0},{"min":3660.01,"max":3680.0,"employer":479.0,"employee":405.0,"total":884.0},{"min":3680.01,"max":3700.0,"employer":481.0,"employee":407.0,"total":888.0},{"min":3700.01,"max":3720.0,"employer":484.0,"employee":410.0,"total":894.0},{"min":3720.01,"max":3740.0,"employer":487.0,"employee":412.0,"total":899.0},{"min":3740.01,"max":3760.0,"employer":489.0,"employee":414.0,"total":903.0},{"min":3760.01,"max":3780.0,"employer":492.0,"employee":416.0,"total":908.0},{"min":3780.01,"max":3800.0,"employer":494.0,"employee":418.0,"total":912.0},{"min":3800.01,"max":3820.0,"employer":497.0,"employee":421.0,"total":918.0},{"min":3820.01,"max":3840.0,"employer":500.0,"employee":423.0,"total":923.0},{"min":3840.01,"max":3860.0,"employer":502.0,"employee":425.0,"total":927.0},{"min":3860.01,"max":3880.0,"employer":505.0,"employee":427.0,"total":932.0},{"min":3880.01,"max":3900.0,"employer":507.0,"employee":429.0,"total":936.0},{"min":3900.01,"max":3920.0,"employer":510.0,"employee":432.0,"total":942.0},{"min":3920.01,"max":3940.0,"employer":513.0,"employee":434.0,"total":947.0},{"min":3940.01,"max":3960.0,"employer":515.0,"employee":436.0,"total":951.0},{"min":3960.01,"max":3980.0,"employer":518.0,"employee":438.0,"total":956.0},{"min":3980.01,"max":4000.0,"employer":520.0,"employee":440.0,"total":960.0},{"min":4000.01,"max":4020.0,"employer":523.0,"employee":443.0,"total":966.0},{"min":4020.01,"max":4040.0,"employer":526.0,"employee":445.0,"total":971.0},{"min":4040.01,"max":4060.0,"employer":528.0,"employee":447.0,"total":975.0},{"min":4060.01,"max":4080.0,"employer":531.0,"employee":449.0,"total":980.0},{"min":4080.01,"max":4100.0,"employer":533.0,"employee":451.0,"total":984.0},{"min":4100.01,"max":4120.0,"employer":536.0,"employee":454.0,"total":990.0},{"min":4120.01,"max":4140.0,"employer":539.0,"employee":456.0,"total":995.0},{"min":4140.01,"max":4160.0,"employer":541.0,"employee":458.0,"total":999.0},{"min":4160.01,"max":4180.0,"employer":544.0,"employee":460.0,"total":1004.0},{"min":4180.01,"max":4200.0,"employer":546.0,"employee":462.0,"total":1008.0},{"min":4200.01,"max":4220.0,"employer":549.0,"employee":465.0,"total":1014.0},{"min":4220.01,"max":4240.0,"employer":552.0,"employee":467.0,"total":1019.0},{"min":4240.01,"max":4260.0,"employer":554.0,"employee":469.0,"total":1023.0},{"min":4260.01,"max":4280.0,"employer":557.0,"employee":471.0,"total":1028.0},{"min":4280.01,"max":4300.0,"employer":559.0,"employee":473.0,"total":1032.0},{"min":4300.01,"max":4320.0,"employer":562.0,"employee":476.0,"total":1038.0},{"min":4320.01,"max":4340.0,"employer":565.0,"employee":478.0,"total":1043.0},{"min":4340.01,"max":4360.0,"employer":567.0,"employee":480.0,"total":1047.0},{"min":4360.01,"max":4380.0,"employer":570.0,"employee":482.0,"total":1052.0},{"min":4380.01,"max":4400.0,"employer":572.0,"employee":484.0,"total":1056.0},{"min":4400.01,"max":4420.0,"employer":575.0,"employee":487.0,"total":1062.0},{"min":4420.01,"max":4440.0,"employer":578.0,"employee":489.0,"total":1067.0},{"min":4440.01,"max":4460.0,"employer":580.0,"employee":491.0,"total":1071.0},{"min":4460.01,"max":4480.0,"employer":583.0,"employee":493.0,"total":1076.0},{"min":4480.01,"max":4500.0,"employer":585.0,"employee":495.0,"total":1080.0},{"min":4500.01,"max":4520.0,"employer":588.0,"employee":498.0,"total":1086.0},{"min":4520.01,"max":4540.0,"employer":591.0,"employee":500.0,"total":1091.0},{"min":4540.01,"max":4560.0,"employer":593.0,"employee":502.0,"total":1095.0},{"min":4560.01,"max":4580.0,"employer":596.0,"employee":504.0,"total":1100.0},{"min":4580.01,"max":4600.0,"employer":598.0,"employee":506.0,"total":1104.0},{"min":4600.01,"max":4620.0,"employer":601.0,"employee":509.0,"total":1110.0},{"min":4620.01,"max":4640.0,"employer":604.0,"employee":511.0,"total":1115.0},{"min":4640.01,"max":4660.0,"employer":606.0,"employee":513.0,"total":1119.0},{"min":4660.01,"max":4680.0,"employer":609.0,"employee":515.0,"total":1124.0},{"min":4680.01,"max":4700.0,"employer":611.0,"employee":517.0,"total":1128.0},{"min":4700.01,"max":4720.0,"employer":614.0,"employee":520.0,"total":1134.0},{"min":4720.01,"max":4740.0,"employer":617.0,"employee":522.0,"total":1139.0},{"min":4740.01,"max":4760.0,"employer":619.0,"employee":524.0,"total":1143.0},{"min":4760.01,"max":4780.0,"employer":622.0,"employee":526.0,"total":1148.0},{"min":4780.01,"max":4800.0,"employer":624.0,"employee":528.0,"total":1152.0},{"min":4800.01,"max":4820.0,"employer":627.0,"employee":531.0,"total":1158.0},{"min":4820.01,"max":4840.0,"employer":630.0,"employee":533.0,"total":1163.0},{"min":4840.01,"max":4860.0,"employer":632.0,"employee":535.0,"total":1167.0},{"min":4860.01,"max":4880.0,"employer":635.0,"employee":537.0,"total":1172.0},{"min":4880.01,"max":4900.0,"employer":637.0,"employee":539.0,"total":1176.0},{"min":4900.01,"max":4920.0,"employer":640.0,"employee":542.0,"total":1182.0},{"min":4920.01,"max":4940.0,"employer":643.0,"employee":544.0,"total":1187.0},{"min":4940.01,"max":4960.0,"employer":645.0,"employee":546.0,"total":1191.0},{"min":4960.01,"max":4980.0,"employer":648.0,"employee":548.0,"total":1196.0},{"min":4980.01,"max":5000.0,"employer":650.0,"employee":550.0,"total":1200.0},{"min":5000.01,"max":5100.0,"employer":612.0,"employee":561.0,"total":1173.0},{"min":5100.01,"max":5200.0,"employer":624.0,"employee":572.0,"total":1196.0},{"min":5200.01,"max":5300.0,"employer":636.0,"employee":583.0,"total":1219.0},{"min":5300.01,"max":5400.0,"employer":648.0,"employee":594.0,"total":1242.0},{"min":5400.01,"max":5500.0,"employer":660.0,"employee":605.0,"total":1265.0},{"min":5500.01,"max":5600.0,"employer":672.0,"employee":616.0,"total":1288.0},{"min":5600.01,"max":5700.0,"employer":684.0,"employee":627.0,"total":1311.0},{"min":5700.01,"max":5800.0,"employer":696.0,"employee":638.0,"total":1334.0},{"min":5800.01,"max":5900.0,"employer":708.0,"employee":649.0,"total":1357.0},{"min":5900.01,"max":6000.0,"employer":720.0,"employee":660.0,"total":1380.0},{"min":6000.01,"max":6100.0,"employer":732.0,"employee":671.0,"total":1403.0},{"min":6100.01,"max":6200.0,"employer":744.0,"employee":682.0,"total":1426.0},{"min":6200.01,"max":6300.0,"employer":756.0,"employee":693.0,"total":1449.0},{"min":6300.01,"max":6400.0,"employer":768.0,"employee":704.0,"total":1472.0},{"min":6400.01,"max":6500.0,"employer":780.0,"employee":715.0,"total":1495.0},{"min":6500.01,"max":6600.0,"employer":792.0,"employee":726.0,"total":1518.0},{"min":6600.01,"max":6700.0,"employer":804.0,"employee":737.0,"total":1541.0},{"min":6700.01,"max":6800.0,"employer":816.0,"employee":748.0,"total":1564.0},{"min":6800.01,"max":6900.0,"employer":828.0,"employee":759.0,"total":1587.0},{"min":6900.01,"max":7000.0,"employer":840.0,"employee":770.0,"total":1610.0},{"min":7000.01,"max":7100.0,"employer":852.0,"employee":781.0,"total":1633.0},{"min":7100.01,"max":7200.0,"employer":864.0,"employee":792.0,"total":1656.0},{"min":7200.01,"max":7300.0,"employer":876.0,"employee":803.0,"total":1679.0},{"min":7300.01,"max":7400.0,"employer":888.0,"employee":814.0,"total":1702.0},{"min":7400.01,"max":7500.0,"employer":900.0,"employee":825.0,"total":1725.0},{"min":7500.01,"max":7600.0,"employer":912.0,"employee":836.0,"total":1748.0},{"min":7600.01,"max":7700.0,"employer":924.0,"employee":847.0,"total":1771.0},{"min":7700.01,"max":7800.0,"employer":936.0,"employee":858.0,"total":1794.0},{"min":7800.01,"max":7900.0,"employer":948.0,"employee":869.0,"total":1817.0},{"min":7900.01,"max":8000.0,"employer":960.0,"employee":880.0,"total":1840.0},{"min":8000.01,"max":8100.0,"employer":972.0,"employee":891.0,"total":1863.0},{"min":8100.01,"max":8200.0,"employer":984.0,"employee":902.0,"total":1886.0},{"min":8200.01,"max":8300.0,"employer":996.0,"employee":913.0,"total":1909.0},{"min":8300.01,"max":8400.0,"employer":1008.0,"employee":924.0,"total":1932.0},{"min":8400.01,"max":8500.0,"employer":1020.0,"employee":935.0,"total":1955.0},{"min":8500.01,"max":8600.0,"employer":1032.0,"employee":946.0,"total":1978.0},{"min":8600.01,"max":8700.0,"employer":1044.0,"employee":957.0,"total":2001.0},{"min":8700.01,"max":8800.0,"employer":1056.0,"employee":968.0,"total":2024.0},{"min":8800.01,"max":8900.0,"employer":1068.0,"employee":979.0,"total":2047.0},{"min":8900.01,"max":9000.0,"employer":1080.0,"employee":990.0,"total":2070.0},{"min":9000.01,"max":9100.0,"employer":1092.0,"employee":1001.0,"total":2093.0},{"min":9100.01,"max":9200.0,"employer":1104.0,"employee":1012.0,"total":2116.0},{"min":9200.01,"max":9300.0,"employer":1116.0,"employee":1023.0,"total":2139.0},{"min":9300.01,"max":9400.0,"employer":1128.0,"employee":1034.0,"total":2162.0},{"min":9400.01,"max":9500.0,"employer":1140.0,"employee":1045.0,"total":2185.0},{"min":9500.01,"max":9600.0,"employer":1152.0,"employee":1056.0,"total":2208.0},{"min":9600.01,"max":9700.0,"employer":1164.0,"employee":1067.0,"total":2231.0},{"min":9700.01,"max":9800.0,"employer":1176.0,"employee":1078.0,"total":2254.0},{"min":9800.01,"max":9900.0,"employer":1188.0,"employee":1089.0,"total":2277.0},{"min":9900.01,"max":10000.0,"employer":1200.0,"employee":1100.0,"total":2300.0},{"min":10000.01,"max":10100.0,"employer":1212.0,"employee":1111.0,"total":2323.0},{"min":10100.01,"max":10200.0,"employer":1224.0,"employee":1122.0,"total":2346.0},{"min":10200.01,"max":10300.0,"employer":1236.0,"employee":1133.0,"total":2369.0},{"min":10300.01,"max":10400.0,"employer":1248.0,"employee":1144.0,"total":2392.0},{"min":10400.01,"max":10500.0,"employer":1260.0,"employee":1155.0,"total":2415.0},{"min":10500.01,"max":10600.0,"employer":1272.0,"employee":1166.0,"total":2438.0},{"min":10600.01,"max":10700.0,"employer":1284.0,"employee":1177.0,"total":2461.0},{"min":10700.01,"max":10800.0,"employer":1296.0,"employee":1188.0,"total":2484.0},{"min":10800.01,"max":10900.0,"employer":1308.0,"employee":1199.0,"total":2507.0},{"min":10900.01,"max":11000.0,"employer":1320.0,"employee":1210.0,"total":2530.0},{"min":11000.01,"max":11100.0,"employer":1332.0,"employee":1221.0,"total":2553.0},{"min":11100.01,"max":11200.0,"employer":1344.0,"employee":1232.0,"total":2576.0},{"min":11200.01,"max":11300.0,"employer":1356.0,"employee":1243.0,"total":2599.0},{"min":11300.01,"max":11400.0,"employer":1368.0,"employee":1254.0,"total":2622.0},{"min":11400.01,"max":11500.0,"employer":1380.0,"employee":1265.0,"total":2645.0},{"min":11500.01,"max":11600.0,"employer":1392.0,"employee":1276.0,"total":2668.0},{"min":11600.01,"max":11700.0,"employer":1404.0,"employee":1287.0,"total":2691.0},{"min":11700.01,"max":11800.0,"employer":1416.0,"employee":1298.0,"total":2714.0},{"min":11800.01,"max":11900.0,"employer":1428.0,"employee":1309.0,"total":2737.0},{"min":11900.01,"max":12000.0,"employer":1440.0,"employee":1320.0,"total":2760.0},{"min":12000.01,"max":12100.0,"employer":1452.0,"employee":1331.0,"total":2783.0},{"min":12100.01,"max":12200.0,"employer":1464.0,"employee":1342.0,"total":2806.0},{"min":12200.01,"max":12300.0,"employer":1476.0,"employee":1353.0,"total":2829.0},{"min":12300.01,"max":12400.0,"employer":1488.0,"employee":1364.0,"total":2852.0},{"min":12400.01,"max":12500.0,"employer":1500.0,"employee":1375.0,"total":2875.0},{"min":12500.01,"max":12600.0,"employer":1512.0,"employee":1386.0,"total":2898.0},{"min":12600.01,"max":12700.0,"employer":1524.0,"employee":1397.0,"total":2921.0},{"min":12700.01,"max":12800.0,"employer":1536.0,"employee":1408.0,"total":2944.0},{"min":12800.01,"max":12900.0,"employer":1548.0,"employee":1419.0,"total":2967.0},{"min":12900.01,"max":13000.0,"employer":1560.0,"employee":1430.0,"total":2990.0},{"min":13000.01,"max":13100.0,"employer":1572.0,"employee":1441.0,"total":3013.0},{"min":13100.01,"max":13200.0,"employer":1584.0,"employee":1452.0,"total":3036.0},{"min":13200.01,"max":13300.0,"employer":1596.0,"employee":1463.0,"total":3059.0},{"min":13300.01,"max":13400.0,"employer":1608.0,"employee":1474.0,"total":3082.0},{"min":13400.01,"max":13500.0,"employer":1620.0,"employee":1485.0,"total":3105.0},{"min":13500.01,"max":13600.0,"employer":1632.0,"employee":1496.0,"total":3128.0},{"min":13600.01,"max":13700.0,"employer":1644.0,"employee":1507.0,"total":3151.0},{"min":13700.01,"max":13800.0,"employer":1656.0,"employee":1518.0,"total":3174.0},{"min":13800.01,"max":13900.0,"employer":1668.0,"employee":1529.0,"total":3197.0},{"min":13900.01,"max":14000.0,"employer":1680.0,"employee":1540.0,"total":3220.0},{"min":14000.01,"max":14100.0,"employer":1692.0,"employee":1551.0,"total":3243.0},{"min":14100.01,"max":14200.0,"employer":1704.0,"employee":1562.0,"total":3266.0},{"min":14200.01,"max":14300.0,"employer":1716.0,"employee":1573.0,"total":3289.0},{"min":14300.01,"max":14400.0,"employer":1728.0,"employee":1584.0,"total":3312.0},{"min":14400.01,"max":14500.0,"employer":1740.0,"employee":1595.0,"total":3335.0},{"min":14500.01,"max":14600.0,"employer":1752.0,"employee":1606.0,"total":3358.0},{"min":14600.01,"max":14700.0,"employer":1764.0,"employee":1617.0,"total":3381.0},{"min":14700.01,"max":14800.0,"employer":1776.0,"employee":1628.0,"total":3404.0},{"min":14800.01,"max":14900.0,"employer":1788.0,"employee":1639.0,"total":3427.0},{"min":14900.01,"max":15000.0,"employer":1800.0,"employee":1650.0,"total":3450.0},{"min":15000.01,"max":15100.0,"employer":1812.0,"employee":1661.0,"total":3473.0},{"min":15100.01,"max":15200.0,"employer":1824.0,"employee":1672.0,"total":3496.0},{"min":15200.01,"max":15300.0,"employer":1836.0,"employee":1683.0,"total":3519.0},{"min":15300.01,"max":15400.0,"employer":1848.0,"employee":1694.0,"total":3542.0},{"min":15400.01,"max":15500.0,"employer":1860.0,"employee":1705.0,"total":3565.0},{"min":15500.01,"max":15600.0,"employer":1872.0,"employee":1716.0,"total":3588.0},{"min":15600.01,"max":15700.0,"employer":1884.0,"employee":1727.0,"total":3611.0},{"min":15700.01,"max":15800.0,"employer":1896.0,"employee":1738.0,"total":3634.0},{"min":15800.01,"max":15900.0,"employer":1908.0,"employee":1749.0,"total":3657.0},{"min":15900.01,"max":16000.0,"employer":1920.0,"employee":1760.0,"total":3680.0},{"min":16000.01,"max":16100.0,"employer":1932.0,"employee":1771.0,"total":3703.0},{"min":16100.01,"max":16200.0,"employer":1944.0,"employee":1782.0,"total":3726.0},{"min":16200.01,"max":16300.0,"employer":1956.0,"employee":1793.0,"total":3749.0},{"min":16300.01,"max":16400.0,"employer":1968.0,"employee":1804.0,"total":3772.0},{"min":16400.01,"max":16500.0,"employer":1980.0,"employee":1815.0,"total":3795.0},{"min":16500.01,"max":16600.0,"employer":1992.0,"employee":1826.0,"total":3818.0},{"min":16600.01,"max":16700.0,"employer":2004.0,"employee":1837.0,"total":3841.0},{"min":16700.01,"max":16800.0,"employer":2016.0,"employee":1848.0,"total":3864.0},{"min":16800.01,"max":16900.0,"employer":2028.0,"employee":1859.0,"total":3887.0},{"min":16900.01,"max":17000.0,"employer":2040.0,"employee":1870.0,"total":3910.0},{"min":17000.01,"max":17100.0,"employer":2052.0,"employee":1881.0,"total":3933.0},{"min":17100.01,"max":17200.0,"employer":2064.0,"employee":1892.0,"total":3956.0},{"min":17200.01,"max":17300.0,"employer":2076.0,"employee":1903.0,"total":3979.0},{"min":17300.01,"max":17400.0,"employer":2088.0,"employee":1914.0,"total":4002.0},{"min":17400.01,"max":17500.0,"employer":2100.0,"employee":1925.0,"total":4025.0},{"min":17500.01,"max":17600.0,"employer":2112.0,"employee":1936.0,"total":4048.0},{"min":17600.01,"max":17700.0,"employer":2124.0,"employee":1947.0,"total":4071.0},{"min":17700.01,"max":17800.0,"employer":2136.0,"employee":1958.0,"total":4094.0},{"min":17800.01,"max":17900.0,"employer":2148.0,"employee":1969.0,"total":4117.0},{"min":17900.01,"max":18000.0,"employer":2160.0,"employee":1980.0,"total":4140.0},{"min":18000.01,"max":18100.0,"employer":2172.0,"employee":1991.0,"total":4163.0},{"min":18100.01,"max":18200.0,"employer":2184.0,"employee":2002.0,"total":4186.0},{"min":18200.01,"max":18300.0,"employer":2196.0,"employee":2013.0,"total":4209.0},{"min":18300.01,"max":18400.0,"employer":2208.0,"employee":2024.0,"total":4232.0},{"min":18400.01,"max":18500.0,"employer":2220.0,"employee":2035.0,"total":4255.0},{"min":18500.01,"max":18600.0,"employer":2232.0,"employee":2046.0,"total":4278.0},{"min":18600.01,"max":18700.0,"employer":2244.0,"employee":2057.0,"total":4301.0},{"min":18700.01,"max":18800.0,"employer":2256.0,"employee":2068.0,"total":4324.0},{"min":18800.01,"max":18900.0,"employer":2268.0,"employee":2079.0,"total":4347.0},{"min":18900.01,"max":19000.0,"employer":2280.0,"employee":2090.0,"total":4370.0},{"min":19000.01,"max":19100.0,"employer":2292.0,"employee":2101.0,"total":4393.0},{"min":19100.01,"max":19200.0,"employer":2304.0,"employee":2112.0,"total":4416.0},{"min":19200.01,"max":19300.0,"employer":2316.0,"employee":2123.0,"total":4439.0},{"min":19300.01,"max":19400.0,"employer":2328.0,"employee":2134.0,"total":4462.0},{"min":19400.01,"max":19500.0,"employer":2340.0,"employee":2145.0,"total":4485.0},{"min":19500.01,"max":19600.0,"employer":2352.0,"employee":2156.0,"total":4508.0},{"min":19600.01,"max":19700.0,"employer":2364.0,"employee":2167.0,"total":4531.0},{"min":19700.01,"max":19800.0,"employer":2376.0,"employee":2178.0,"total":4554.0},{"min":19800.01,"max":19900.0,"employer":2388.0,"employee":2189.0,"total":4577.0},{"min":19900.01,"max":20000.0,"employer":2400.0,"employee":2200.0,"total":4600.0}];

        function lookupEpfFromTable(wages) {
            // EPF table in Jadual Ketiga uses wage bands like "From 9,900.01 to 10,000.00"
            // We match using the upper bound (max) and wages in range [min, max].
            if (!isFinite(wages) || wages <= 0) {
                return { employer: 0, employee: 0, total: 0 };
            }
            // Binary search by band max
            let lo = 0, hi = EPF_TABLE.length - 1, ans = -1;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                if (wages <= EPF_TABLE[mid].max) {
                    ans = mid;
                    hi = mid - 1;
                } else {
                    lo = mid + 1;
                }
            }
            if (ans === -1) {
                // Above last band: use last row (table ends at 20,000)
                const last = EPF_TABLE[EPF_TABLE.length - 1];
                return { employer: last.employer, employee: last.employee, total: last.total };
            }
            const row = EPF_TABLE[ans];
            // Ensure wage is not below row.min due to binary by max (edge cases)
            if (wages < row.min) {
                // fall back to previous row if any
                const prev = ans > 0 ? EPF_TABLE[ans - 1] : row;
                return { employer: prev.employer, employee: prev.employee, total: prev.total };
            }
            return { employer: row.employer, employee: row.employee, total: row.total };
        }

        function calculateEpf(wages) {
            const r = lookupEpfFromTable(wages);
            return {
                employer: r.employer,
                employee: r.employee,
                total: r.total
            };
        }

        function calculateSocso(salary) {
            // Based on the fixed amounts shown in your screenshots (capped schedule)
            // Uses the nearest lower band.
            const s = Math.max(0, salary || 0);
            const bands = [
                { upTo: 3000, employer: 51.65, employee: 14.75 },
                { upTo: 4000, employer: 69.15, employee: 19.75 },
                { upTo: 5000, employer: 86.65, employee: 24.75 },
                { upTo: 6000, employer: 104.15, employee: 29.75 },
                { upTo: Infinity, employer: 104.15, employee: 29.75 }
            ];
            let chosen = bands[0];
            for (const b of bands) {
                if (s <= b.upTo) { chosen = b; break; }
            }
            const total = Math.round((chosen.employer + chosen.employee) * 100) / 100;
            return {
                employer: chosen.employer,
                employee: chosen.employee,
                total
            };
        }

        function calculateEis(salary) {
            // Based on your screenshots (capped schedule)
            const s = Math.max(0, salary || 0);
            const bands = [
                { upTo: 3000, employer: 5.90, employee: 5.90 },
                { upTo: 4000, employer: 7.90, employee: 7.90 },
                { upTo: 5000, employer: 9.90, employee: 9.90 },
                { upTo: 6000, employer: 11.90, employee: 11.90 },
                { upTo: Infinity, employer: 11.90, employee: 11.90 }
            ];
            let chosen = bands[0];
            for (const b of bands) {
                if (s <= b.upTo) { chosen = b; break; }
            }
            const total = Math.round((chosen.employer + chosen.employee) * 100) / 100;
            return {
                employer: chosen.employer,
                employee: chosen.employee,
                total
            };
        }

        function interpolate(x, x0, y0, x1, y1) {
            if (x1 === x0) return y0;
            return y0 + (x - x0) * (y1 - y0) / (x1 - x0);
        }
        // =========================
        // PCB (MTD) TABLE LOOKUP
        // Source: LHDN Schedule of Monthly Tax Deductions (Effective 2018) - "PCB Calculation.pdf"
        // We support table lookups up to RM60,000 monthly net remuneration.
        // Above RM60,000 we fall back to the old "Auto PCB" approximation.
        // =========================

        const PCB_BASE = 3141;
        const PCB_STEP = 5;
        const PCB_MAX = 60000;

        const PCB_COLUMNS = ["B", "K2", "KA1_2", "KA2_2", "KA3_2", "KA4_2", "KA5_2", "KA6_2", "KA7_2", "KA8_2", "KA9_2", "KA10_2", "K3", "KA1_3", "KA2_3", "KA3_3", "KA4_3", "KA5_3", "KA6_3", "KA7_3", "KA8_3", "KA9_3", "KA10_3"];


        let _pcbData = null; // { colName: Float64Array }

        function loadPcbTable() {
            if (_pcbData) return _pcbData;
            const lines = PCB_TABLE_TEXT.trim().split(/\n+/);
            const n = lines.length;

            const data = {};
            for (const col of PCB_COLUMNS) data[col] = new Float64Array(n);

            for (let i = 0; i < n; i++) {
                const parts = lines[i].trim().split(/\s+/);
                let k = 1; // skip "from-to"
                for (let c = 0; c < PCB_COLUMNS.length; c++, k++) {
                    const t = parts[k];
                    data[PCB_COLUMNS[c]][i] = (t === '-' || t === undefined) ? 0 : parseFloat(t);
                }
            }

            _pcbData = data;
            return _pcbData;
        }

        function pcbLookup(monthlyNetRemuneration, pcbCategoryKey) {
            const net = Math.floor(monthlyNetRemuneration);

            if (net < PCB_BASE) return 0;
            if (net > PCB_MAX) return null;

            const data = loadPcbTable();
            const idx = Math.floor((net - PCB_BASE) / PCB_STEP);

            const col = data[pcbCategoryKey] ? pcbCategoryKey : 'B';
            const val = data[col][idx] || 0;

            return Math.round(val * 100) / 100;
        }

        // Fallback: previous approximation based on your screenshot points (gross salary → PCB).
        function autoPcbApproxFromGross(monthlySalary) {
                        // PCB: match your screenshot points and interpolate between them.
                        const s = Math.max(0, monthlySalary || 0);
            
                        const pcbPoints = [
                            { salary: 3000, pcb: 0.00 },
                            { salary: 4000, pcb: 16.70 },
                            { salary: 5000, pcb: 110.00 },
                            { salary: 10000, pcb: 929.20 },
                            { salary: 11000, pcb: 1179.20 },
                            { salary: 12000, pcb: 1429.20 },
                            { salary: 13000, pcb: 1679.20 },
                            { salary: 14000, pcb: 1929.20 }
                        ];
            
                        if (s <= pcbPoints[0].salary) return pcbPoints[0].pcb;
            
                        for (let i = 0; i < pcbPoints.length - 1; i++) {
                            const a = pcbPoints[i];
                            const b = pcbPoints[i + 1];
                            if (s <= b.salary) {
                                const v = interpolate(s, a.salary, a.pcb, b.salary, b.pcb);
                                return Math.round(v * 100) / 100;
                            }
                        }
            
                        // Above the last point: extend using last segment slope
                        const n = pcbPoints.length;
                        const a = pcbPoints[n - 2], b = pcbPoints[n - 1];
                        const v = interpolate(s, a.salary, a.pcb, b.salary, b.pcb);
                        return Math.round(v * 100) / 100;
        }

        // Main PCB function used by Salary tab:
        // Uses table lookup (<= RM60k net) + category selection, otherwise fallback to Auto PCB.
        function calculateTax(monthlySalary, employeeEpf, pcbCategoryKey) {
            const net = monthlySalary - (employeeEpf || 0);
            const tableVal = pcbLookup(net, pcbCategoryKey);
            if (tableVal !== null) return tableVal;
            return autoPcbApproxFromGross(monthlySalary);
        }


        function updateSalaryCalculatorDisplay() {
            const salary = parseFloat(document.getElementById('basicSalary').value) || 0;
            const bonus = parseFloat(document.getElementById('bonus').value) || 0;
            // Calculate total salary
            const totalSalary = salary + bonus;
            
            // Calculate all deductions
            const epf = calculateEpf(totalSalary);
            const socso = calculateSocso(totalSalary);
            const eis = calculateEis(totalSalary);
            const pcbCategoryKey = (document.getElementById('pcbCategory')?.value) || 'B';
            const tax = calculateTax(totalSalary, epf.employee, pcbCategoryKey);
            
            // Calculate totals
            const employeeDeductions = epf.employee + socso.employee + eis.employee + tax;
            const employerContributions = epf.employer + socso.employer + eis.employer;
            const netSalary = totalSalary - employeeDeductions;
            
            // Update salary statement
            document.getElementById('salaryDisplay').textContent = formatCurrency(salary);
            document.getElementById('bonusDisplay').textContent = formatCurrency(bonus);
            document.getElementById('netSalaryDisplay').textContent = formatCurrency(netSalary);
            
            // Update deductions breakdown
            document.getElementById('epfEmployer').textContent = formatCurrency(epf.employer);
            document.getElementById('epfEmployee').textContent = formatCurrency(epf.employee);
            document.getElementById('epfTotal').textContent = formatCurrency(epf.total);
            
            document.getElementById('socsoEmployer').textContent = formatCurrency(socso.employer);
            document.getElementById('socsoEmployee').textContent = formatCurrency(socso.employee);
            document.getElementById('socsoTotal').textContent = formatCurrency(socso.total);
            
            document.getElementById('eisEmployer').textContent = formatCurrency(eis.employer);
            document.getElementById('eisEmployee').textContent = formatCurrency(eis.employee);
            document.getElementById('eisTotal').textContent = formatCurrency(eis.total);
            
            document.getElementById('taxEmployee').textContent = formatCurrency(tax);
            document.getElementById('taxTotal').textContent = formatCurrency(tax);
            
            document.getElementById('totalEmployer').textContent = formatCurrency(employerContributions);
            document.getElementById('totalEmployee').textContent = formatCurrency(employeeDeductions);
            document.getElementById('totalAll').textContent = formatCurrency(employerContributions + employeeDeductions);
        }

        // Housing Loan Calculator Functions
        function updateExistingCommitments() {
            const carLoan = parseFloat(document.getElementById('carLoan').value) || 0;
            const ptptn = parseFloat(document.getElementById('ptptn').value) || 0;
            const creditCard = parseFloat(document.getElementById('creditCard').value) || 0;
            const personalLoan = parseFloat(document.getElementById('personalLoan').value) || 0;
            const otherCommitments = parseFloat(document.getElementById('otherCommitments').value) || 0;
            
            const totalExistingCommitments = carLoan + ptptn + creditCard + personalLoan + otherCommitments;
            document.getElementById('existingCommitmentsDisplay').textContent = formatCurrency(totalExistingCommitments);

            // Update Breakdown
            const breakdownContainer = document.getElementById('commitmentsBreakdown');
            const items = [
                { label: 'Car Loan', value: carLoan },
                { label: 'PTPTN', value: ptptn },
                { label: 'Credit Card', value: creditCard },
                { label: 'Personal Loan', value: personalLoan },
                { label: 'Others', value: otherCommitments }
            ];

            let breakdownHTML = '';
            let hasItems = false;

            items.forEach(item => {
                if (item.value > 0) {
                    hasItems = true;
                    breakdownHTML += `
                        <div class="commitment-item">
                            <span>${item.label}</span>
                            <span>${formatCurrency(item.value)}</span>
                        </div>
                    `;
                }
            });

            breakdownContainer.innerHTML = breakdownHTML;
            if (hasItems) {
                breakdownContainer.classList.add('active');
            } else {
                breakdownContainer.classList.remove('active');
            }
        }

        function calculateMonthlyPayment(loanAmount, interestRate, loanTenure) {
            const monthlyRate = interestRate / 100 / 12;
            const numberOfPayments = loanTenure * 12;
            
            const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) / 
                                  (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
            
            return monthlyPayment;
        }

        function calculateDsrScore(monthlyIncome, totalMonthlyCommitments) {
            return (totalMonthlyCommitments / monthlyIncome) * 100;
        }

        function getDsrStatus(dsrScore) {
            if (dsrScore <= 30) {
                return {
                    status: "Good",
                    class: "dsr-good",
                    message: "You're financially ready!"
                };
            } else if (dsrScore <= 50) {
                return {
                    status: "Moderate",
                    class: "dsr-moderate",
                    message: "Manageable but be cautious"
                };
            } else if (dsrScore <= 70) {
                return {
                    status: "High",
                    class: "dsr-high",
                    message: "Consider reducing other commitments"
                };
            } else {
                return {
                    status: "Very High",
                    class: "dsr-very-high",
                    message: "Financial risk - reconsider loan"
                };
            }
        }

        function updateUpfrontCosts(propertyType) {
            const propertyPrice = parseFloat(document.getElementById('propertyPrice').value) || 0;
            const downpaymentPercent = parseFloat(document.getElementById('downpaymentPercent').value) || 0;
            const loanAmount = propertyPrice - (propertyPrice * (downpaymentPercent / 100));
            
            if (propertyType === 'new') {
                // Get percentage values
                const downpaymentPercent = parseFloat(document.getElementById('newDownpaymentPercent').value) || 0;
                const spLegalFeePercent = parseFloat(document.getElementById('newSpLegalFeePercent').value) || 0;
                const stampDutyPercent = parseFloat(document.getElementById('newStampDutyPercent').value) || 0;
                const loanLegalFeePercent = parseFloat(document.getElementById('newLoanLegalFeePercent').value) || 0;
                const loanStampDutyPercent = parseFloat(document.getElementById('newLoanStampDutyPercent').value) || 0;
                
                // Calculate amounts
                const downpaymentAmount = propertyPrice * (downpaymentPercent / 100);
                const spLegalFeeAmount = propertyPrice * (spLegalFeePercent / 100);
                const stampDutyAmount = propertyPrice * (stampDutyPercent / 100);
                const loanLegalFeeAmount = loanAmount * (loanLegalFeePercent / 100);
                const loanStampDutyAmount = loanAmount * (loanStampDutyPercent / 100);
                const totalUpfrontCostAmount = downpaymentAmount + spLegalFeeAmount + stampDutyAmount + loanLegalFeeAmount + loanStampDutyAmount;
                
                // Update display
                document.getElementById('newDownpaymentAmount').textContent = formatCurrency(downpaymentAmount);
                document.getElementById('newSpLegalFeeAmount').textContent = formatCurrency(spLegalFeeAmount);
                document.getElementById('newStampDutyAmount').textContent = formatCurrency(stampDutyAmount);
                document.getElementById('newLoanLegalFeeAmount').textContent = formatCurrency(loanLegalFeeAmount);
                document.getElementById('newLoanStampDutyAmount').textContent = formatCurrency(loanStampDutyAmount);
                document.getElementById('newTotalUpfrontCostAmount').textContent = formatCurrency(totalUpfrontCostAmount);
            } else if (propertyType === 'subsale') {
                // Get percentage values
                const downpaymentPercent = parseFloat(document.getElementById('subsaleDownpaymentPercent').value) || 0;
                const spLegalFeePercent = parseFloat(document.getElementById('subsaleSpLegalFeePercent').value) || 0;
                const motPercent = parseFloat(document.getElementById('subsaleMotPercent').value) || 0;
                const loanLegalFeePercent = parseFloat(document.getElementById('subsaleLoanLegalFeePercent').value) || 0;
                const loanStampDutyPercent = parseFloat(document.getElementById('subsaleLoanStampDutyPercent').value) || 0;
                const valuationFeePercent = parseFloat(document.getElementById('subsaleValuationFeePercent').value) || 0;
                
                // Calculate amounts
                const downpaymentAmount = propertyPrice * (downpaymentPercent / 100);
                const spLegalFeeAmount = propertyPrice * (spLegalFeePercent / 100);
                const motAmount = propertyPrice * (motPercent / 100);
                const loanLegalFeeAmount = loanAmount * (loanLegalFeePercent / 100);
                const loanStampDutyAmount = loanAmount * (loanStampDutyPercent / 100);
                const valuationFeeAmount = propertyPrice * (valuationFeePercent / 100);
                const totalUpfrontCostAmount = downpaymentAmount + spLegalFeeAmount + motAmount + loanLegalFeeAmount + loanStampDutyAmount + valuationFeeAmount;
                
                // Update display
                document.getElementById('subsaleDownpaymentAmount').textContent = formatCurrency(downpaymentAmount);
                document.getElementById('subsaleSpLegalFeeAmount').textContent = formatCurrency(spLegalFeeAmount);
                document.getElementById('subsaleMotAmount').textContent = formatCurrency(motAmount);
                document.getElementById('subsaleLoanLegalFeeAmount').textContent = formatCurrency(loanLegalFeeAmount);
                document.getElementById('subsaleLoanStampDutyAmount').textContent = formatCurrency(loanStampDutyAmount);
                document.getElementById('subsaleValuationFeeAmount').textContent = formatCurrency(valuationFeeAmount);
                document.getElementById('subsaleTotalUpfrontCostAmount').textContent = formatCurrency(totalUpfrontCostAmount);
            }
        }

        function calculateHousingLoan() {
            // Get input values
            const monthlyIncome = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            const propertyPrice = parseFloat(document.getElementById('propertyPrice').value) || 0;
            const loanTenure = parseFloat(document.getElementById('loanTenure').value) || 0;
            const interestRate = parseFloat(document.getElementById('interestRate').value) || 0;
            const downpaymentPercent = parseFloat(document.getElementById('downpaymentPercent').value) || 0;
            
            // Calculate loan amount
            const downpaymentAmount = propertyPrice * (downpaymentPercent / 100);
            const loanAmount = propertyPrice - downpaymentAmount;
            
            // Calculate monthly payment
            const monthlyPayment = calculateMonthlyPayment(loanAmount, interestRate, loanTenure);
            
            // Calculate existing commitments
            const carLoan = parseFloat(document.getElementById('carLoan').value) || 0;
            const ptptn = parseFloat(document.getElementById('ptptn').value) || 0;
            const creditCard = parseFloat(document.getElementById('creditCard').value) || 0;
            const personalLoan = parseFloat(document.getElementById('personalLoan').value) || 0;
            const otherCommitments = parseFloat(document.getElementById('otherCommitments').value) || 0;
            
            const totalExistingCommitments = carLoan + ptptn + creditCard + personalLoan + otherCommitments;
            const totalMonthlyCommitments = totalExistingCommitments + monthlyPayment;
            
            // Calculate DSR score
            const dsrScore = calculateDsrScore(monthlyIncome, totalMonthlyCommitments);
            const dsrStatus = getDsrStatus(dsrScore);
            
            // Update display
            document.getElementById('monthlyRepaymentDisplay').textContent = formatCurrency(monthlyPayment);
            document.getElementById('loanAmountDisplay').textContent = formatCurrency(loanAmount);
            
            const dsrScoreElement = document.getElementById('dsrScoreDisplay');
            dsrScoreElement.textContent = `${dsrScore.toFixed(1)}%`;
            dsrScoreElement.className = `loan-result-value ${dsrStatus.class}`;
            
            document.getElementById('dsrStatusDisplay').textContent = dsrStatus.message;
            
            document.getElementById('totalCommitmentsDisplay').textContent = formatCurrency(totalMonthlyCommitments);
            
            // Update upfront costs for both new property and subsale
            updateUpfrontCosts('new');
            updateUpfrontCosts('subsale');
            
            // Show results section
            document.getElementById('loanResults').classList.remove('hidden');
        }

        function resetHousingLoan() {
            // Reset all input fields to default values
            document.getElementById('monthlyIncome').value = '5000';
            document.getElementById('propertyPrice').value = '300000';
            document.getElementById('loanTenure').value = '30';
            document.getElementById('interestRate').value = '4.5';
            document.getElementById('downpaymentPercent').value = '10';
            document.getElementById('carLoan').value = '0';
            document.getElementById('ptptn').value = '0';
            document.getElementById('creditCard').value = '0';
            document.getElementById('personalLoan').value = '0';
            document.getElementById('otherCommitments').value = '0';
            
            // Reset percentage inputs for upfront costs
            document.getElementById('newDownpaymentPercent').value = '10';
            document.getElementById('newSpLegalFeePercent').value = '1';
            document.getElementById('newStampDutyPercent').value = '2';
            document.getElementById('newLoanLegalFeePercent').value = '1';
            document.getElementById('newLoanStampDutyPercent').value = '0.5';
            
            document.getElementById('subsaleDownpaymentPercent').value = '10';
            document.getElementById('subsaleSpLegalFeePercent').value = '1';
            document.getElementById('subsaleMotPercent').value = '3';
            document.getElementById('subsaleLoanLegalFeePercent').value = '1';
            document.getElementById('subsaleLoanStampDutyPercent').value = '0.5';
            document.getElementById('subsaleValuationFeePercent').value = '0.25';
            
            // Update existing commitments display
            updateExistingCommitments();
            
            // Hide results section
            document.getElementById('loanResults').classList.add('hidden');
        }

        // Add event listeners for Compound Interest Calculator
        document.getElementById('initialAmount').addEventListener('input', updateCompoundInterestDisplay);
        document.getElementById('monthlyContribution').addEventListener('input', updateCompoundInterestDisplay);
        document.getElementById('annualTopup').addEventListener('input', updateCompoundInterestDisplay);
        document.getElementById('annualInterestRate').addEventListener('input', updateCompoundInterestDisplay);
        document.getElementById('yearsLength').addEventListener('input', updateCompoundInterestDisplay);

        // Add event listeners for Salary Calculator
        document.getElementById('basicSalary').addEventListener('input', updateSalaryCalculatorDisplay);
        document.getElementById('bonus').addEventListener('input', updateSalaryCalculatorDisplay);
        document.getElementById('pcbCategory').addEventListener('change', updateSalaryCalculatorDisplay);

        // Add event listeners for Housing Loan Calculator
        document.getElementById('carLoan').addEventListener('input', updateExistingCommitments);
        document.getElementById('ptptn').addEventListener('input', updateExistingCommitments);
        document.getElementById('creditCard').addEventListener('input', updateExistingCommitments);
        document.getElementById('personalLoan').addEventListener('input', updateExistingCommitments);
        document.getElementById('otherCommitments').addEventListener('input', updateExistingCommitments);

        // Initial load
        updateCompoundInterestDisplay();
        updateSalaryCalculatorDisplay();
        updateExistingCommitments();
        
        // Handle window resize for chart responsiveness
        window.addEventListener('resize', function() {
            if (chartInstance) {
                chartInstance.resize();
            }
        });
    </script>
</body>
</html>